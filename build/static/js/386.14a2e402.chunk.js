"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[386],{55386:(e,i,n)=>{n.r(i),n.d(i,{default:()=>Y});var t=n(65043),r=n(83003),a=n(65868),s=n(35475),l=n(62764),o=n(67290),c=n(96651),d=n(3188),u=n(40322),h=n(90696),m=n(91995),p=n(91686),x=n(94434),g=n(75995),v=n(60184),y=n(10254),f=n(34348),b=n.n(f),j=n(70579);const T=e=>{let{trips:i,openDrawer:n,hideAddButton:f,refetch:T}=e;const N=(0,r.wA)(),[k]=(0,a.tJ)(),[C]=(0,a.E8)(),[w,A]=(0,t.useState)({open:!1,severity:"",message:""}),[P,I]=(0,t.useState)(null),[L,D]=(0,t.useState)(!1),[S,H]=(0,t.useState)([]),{data:O,isLoading:_}=(0,l.BI)(),q=(e,i)=>{A({open:!0,severity:e,message:i})},F=[{title:"\u0110i\u1ec3m kh\u1edfi h\xe0nh",dataIndex:["departureLocation","name"],key:"departureLocation"},{title:"\u0110i\u1ec3m \u0111\u1ebfn",dataIndex:["arrivalLocation","name"],key:"arrivalLocation"},{title:"Lo\u1ea1i xe",dataIndex:["busType","name"],key:"busType",render:e=>(0,j.jsx)("span",{className:"bg-green-200 text-green-800 px-2 py-1 rounded-full",children:e})},{title:"Th\u1eddi gian kh\u1edfi h\xe0nh",dataIndex:"departureTime",key:"departureTime",render:e=>y.D.formatDisplayTime(e)},{title:"Th\u1eddi gian \u0111\u1ebfn",dataIndex:"arrivalTime",key:"arrivalTime",render:e=>y.D.formatDisplayTime(e)},{title:"Gi\xe1 v\xe9",dataIndex:"basePrice",key:"basePrice",render:e=>(0,y.v)(e)},{title:"T\xe0i x\u1ebf",dataIndex:"drivers",key:"drivers",render:e=>e&&e.length>0?e.map((e=>(0,j.jsx)("span",{className:"block",children:e.fullName?`${e.fullName} (Driver)`:"Th\xf4ng tin kh\xf4ng x\xe1c \u0111\u1ecbnh"},e._id))):(0,j.jsx)("span",{className:"text-rose-400",children:"Ch\u01b0a c\xf3 t\xe0i x\u1ebf"})},{title:"Thao t\xe1c",key:"action",render:(e,t)=>{const r=t.drivers&&t.drivers.length>0;return(0,j.jsxs)("div",{className:"flex space-x-2",children:[(0,j.jsx)(c.A,{title:"Chi ti\u1ebft",children:(0,j.jsx)(s.N_,{to:`/trips/${t._id}`,className:"text-blue-500 hover:text-blue-700",children:(0,j.jsx)(v.Ny1,{className:"inline mr-1 text-lg align-middle"})})}),(0,j.jsx)(c.A,{title:"S\u1eeda",children:(0,j.jsx)(d.Ay,{type:"link",className:"text-yellow-500 hover:text-yellow-700",onClick:()=>(e=>{const i={...e,departureTime:b().utc(e.departureTime).toISOString(),arrivalTime:b().utc(e.arrivalTime).toISOString()};n(i)})(t),children:(0,j.jsx)(v.uO9,{className:"inline mr-1 text-lg align-middle"})})}),!r&&(0,j.jsx)(c.A,{title:"Th\xeam t\xe0i x\u1ebf",children:(0,j.jsx)(d.Ay,{type:"link",className:"text-green-500 hover:text-green-700",onClick:()=>(I(t),void D(!0)),children:(0,j.jsx)(v.NPy,{className:"inline mr-1 text-lg align-middle"})})}),(0,j.jsx)(c.A,{title:"X\xf3a",children:(0,j.jsx)(u.A,{title:"B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n x\xf3a chuy\u1ebfn \u0111i n\xe0y kh\xf4ng?",onConfirm:()=>(async e=>{try{await k(e).unwrap(),N((0,o.gg)("X\xf3a chuy\u1ebfn \u0111i th\xe0nh c\xf4ng."));const n=i.filter((i=>i._id!==e));N((0,o.hO)(n)),q("success","X\xf3a chuy\u1ebfn \u0111i th\xe0nh c\xf4ng."),T()}catch(n){N((0,o.Nh)("L\u1ed7i khi x\xf3a chuy\u1ebfn \u0111i: "+n.message)),q("error",`L\u1ed7i khi x\xf3a chuy\u1ebfn \u0111i: ${n.message}`)}})(t._id),okText:"C\xf3",cancelText:"Kh\xf4ng",children:(0,j.jsx)(d.Ay,{type:"link",className:"text-red-500 hover:text-red-700",children:(0,j.jsx)(v.qbC,{className:"inline mr-1 text-lg align-middle"})})})})]})}}];return(0,j.jsxs)("div",{className:"p-4",children:[(0,j.jsx)(h.A,{columns:F,dataSource:i,rowKey:e=>e._id,pagination:!1,bordered:!0,className:"bg-white shadow-md rounded-lg overflow-hidden"}),(0,j.jsx)(g.A,{open:w.open,severity:w.severity,message:w.message,onClose:()=>A({...w,open:!1}),anchorOrigin:{vertical:"top",horizontal:"right"}}),(0,j.jsx)(m.A,{title:"Th\xeam t\xe0i x\u1ebf",visible:L,onOk:async()=>{if(S.length)try{await C({tripId:P._id,driverIds:S}).unwrap(),q("success","Th\xeam t\xe0i x\u1ebf th\xe0nh c\xf4ng."),D(!1),T()}catch(n){var e,i;const t=(null===(e=n.data)||void 0===e?void 0:e.message)||"L\u1ed7i khi th\xeam t\xe0i x\u1ebf.",r=(null===(i=n.data)||void 0===i?void 0:i.conflictingDrivers)||[],a=r.length?`C\xe1c t\xe0i x\u1ebf g\xe2y xung \u0111\u1ed9t: ${r.join(", ")}`:"";q("error",`${t} ${a}`)}else q("error","B\u1ea1n ph\u1ea3i ch\u1ecdn \xedt nh\u1ea5t m\u1ed9t t\xe0i x\u1ebf")},onCancel:()=>D(!1),children:_?(0,j.jsx)(p.A,{}):O&&Array.isArray(O.drivers)&&O.drivers.length>0?(0,j.jsx)(x.A,{mode:"multiple",style:{width:"100%"},placeholder:"Ch\u1ecdn t\xe0i x\u1ebf",onChange:e=>H(e),children:O.drivers.map((e=>{var i;return(0,j.jsx)(x.A.Option,{value:e._id,children:null!==(i=e.userId)&&void 0!==i&&i.fullName?e.userId.fullName:"T\xean kh\xf4ng x\xe1c \u0111\u1ecbnh"},e._id)}))}):(0,j.jsx)("p",{children:"Kh\xf4ng c\xf3 t\xe0i x\u1ebf n\xe0o"})})]})};var N=n(31899),k=n.n(N),C=(n(25015),n(39052)),w=n(90480),A=n(86178),P=n.n(A);const I=e=>{var i,n;let{tripId:s,closeDrawer:l}=e;const{companyId:o}=(0,r.d4)((e=>e.user.userInfo)),[c]=(0,a._w)(),[d]=(0,a.Lr)(),{data:u}=(0,a.pY)(s,{skip:!s}),{data:h,isLoading:m}=(0,C.eg)(),{data:p,isLoading:x,error:g}=(0,w.rz)({companyId:o},{skip:!o}),[v,f]=(0,t.useState)({departureLocation:"",arrivalLocation:"",busType:"",departureTime:new Date,arrivalTime:new Date,basePrice:"",isRoundTrip:!1,pickupPoints:[],dropOffPoints:[]});(0,t.useEffect)((()=>{if(u&&u.data){var e,i,n;const t=u.data.trip;f({departureLocation:(null===t||void 0===t||null===(e=t.departureLocation)||void 0===e?void 0:e._id)||"",arrivalLocation:(null===t||void 0===t||null===(i=t.arrivalLocation)||void 0===i?void 0:i._id)||"",busType:(null===t||void 0===t||null===(n=t.busType)||void 0===n?void 0:n._id)||"",departureTime:y.D.parseUTCTimeForForm(t.departureTime),arrivalTime:y.D.parseUTCTimeForForm(t.arrivalTime),basePrice:null===t||void 0===t?void 0:t.basePrice,isRoundTrip:(null===t||void 0===t?void 0:t.isRoundTrip)||!1,pickupPoints:(null===t||void 0===t?void 0:t.pickupPoints)||[],dropOffPoints:(null===t||void 0===t?void 0:t.dropOffPoints)||[]})}}),[u]);const b=e=>{const{name:i,value:n,type:t,checked:r}=e.target;f({...v,[i]:"checkbox"===t?r:n})},T=(e,i)=>{f({...v,[e]:i})},N=(e,i,n)=>{const t=[...v.pickupPoints];t[e][i]=n,f({...v,pickupPoints:t})},A=(e,i,n)=>{const t=[...v.dropOffPoints];t[e][i]=n,f({...v,dropOffPoints:t})};return(0,j.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{const e=((e,i)=>{const n=P()(e);return i.map(((e,i)=>{const t=15*i;return{...e,time:n.clone().add(t,"minutes").format("HH:mm")}}))})(v.departureTime,v.pickupPoints),i=((e,i)=>{const n=P()(e);return i.map(((e,t)=>{const r=15*(i.length-1-t);return{...e,time:n.clone().subtract(r,"minutes").format("HH:mm")}}))})(v.arrivalTime,v.dropOffPoints),n={...v,pickupPoints:e,dropOffPoints:i,departureTime:y.D.formatTimeForServer(v.departureTime),arrivalTime:y.D.formatTimeForServer(v.arrivalTime),basePrice:parseInt(v.basePrice,10)};s?await d({tripId:s,updatedTrip:n}).unwrap():await c(n).unwrap(),l()}catch(i){console.error("L\u1ed7i khi l\u01b0u chuy\u1ebfn \u0111i:",i)}},className:"p-4 bg-white rounded-lg shadow-lg",children:[(0,j.jsxs)("div",{className:"mb-6",children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"\u0110i\u1ec3m Kh\u1edfi H\xe0nh:"}),(0,j.jsxs)("select",{name:"departureLocation",value:v.departureLocation,onChange:b,className:"mt-2 p-2 border rounded w-full focus:ring focus:ring-green-500",required:!0,children:[(0,j.jsx)("option",{value:"",children:"Ch\u1ecdn \u0111i\u1ec3m kh\u1edfi h\xe0nh"}),!m&&(null===h||void 0===h||null===(i=h.data)||void 0===i?void 0:i.map((e=>(0,j.jsxs)("option",{value:e._id,children:[e.name," - ",e.city]},e._id))))]})]}),(0,j.jsxs)("div",{className:"mb-6",children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"\u0110i\u1ec3m \u0110\u1ebfn:"}),(0,j.jsxs)("select",{name:"arrivalLocation",value:v.arrivalLocation,onChange:b,className:"mt-2 p-2 border rounded w-full focus:ring focus:ring-green-500",required:!0,children:[(0,j.jsx)("option",{value:"",children:"Ch\u1ecdn \u0111i\u1ec3m \u0111\u1ebfn"}),!m&&(null===h||void 0===h||null===(n=h.data)||void 0===n?void 0:n.map((e=>(0,j.jsxs)("option",{value:e._id,children:[e.name," - ",e.city]},e._id))))]})]}),(0,j.jsxs)("div",{className:"mb-6",children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Th\u1eddi Gian Kh\u1edfi H\xe0nh:"}),(0,j.jsx)(k(),{selected:v.departureTime,onChange:e=>T("departureTime",e),showTimeSelect:!0,timeFormat:"HH:mm",timeIntervals:15,dateFormat:"dd/MM/yyyy HH:mm",className:"mt-2 p-3 border rounded w-full focus:ring focus:ring-blue-500",required:!0})]}),(0,j.jsxs)("div",{className:"mb-6",children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Th\u1eddi Gian \u0110\u1ebfn:"}),(0,j.jsx)(k(),{selected:v.arrivalTime,onChange:e=>T("arrivalTime",e),showTimeSelect:!0,timeFormat:"HH:mm",timeIntervals:15,dateFormat:"dd/MM/yyyy HH:mm",className:"mt-2 p-3 border rounded w-full focus:ring focus:ring-blue-500",required:!0})]}),(0,j.jsxs)("div",{className:"mb-6",children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"\u0110i\u1ec3m \u0110\xf3n:"}),v.pickupPoints.map(((e,i)=>(0,j.jsxs)("div",{className:"flex items-center mb-2",children:[(0,j.jsx)("input",{type:"text",placeholder:"\u0110\u1ecba \u0111i\u1ec3m",value:e.location,onChange:e=>N(i,"location",e.target.value),className:"mr-2 p-2 border rounded w-2/3 focus:ring focus:ring-green-500",required:!0}),(0,j.jsx)("input",{type:"text",placeholder:"Ghi ch\xfa",value:e.note,onChange:e=>N(i,"note",e.target.value),className:"mr-2 p-2 border rounded w-1/3 focus:ring focus:ring-green-500"}),(0,j.jsx)("button",{type:"button",onClick:()=>(e=>{const i=[...v.pickupPoints];i.splice(e,1),f({...v,pickupPoints:i})})(i),className:"text-red-500 hover:text-red-700",children:"X\xf3a"})]},i))),(0,j.jsx)("button",{type:"button",onClick:()=>{f({...v,pickupPoints:[...v.pickupPoints,{location:"",note:""}]})},className:"mt-2 text-blue-500 hover:text-blue-700",children:"+ Th\xeam \u0110i\u1ec3m \u0110\xf3n"})]}),(0,j.jsxs)("div",{className:"mb-6",children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"\u0110i\u1ec3m Tr\u1ea3:"}),v.dropOffPoints.map(((e,i)=>(0,j.jsxs)("div",{className:"flex items-center mb-2",children:[(0,j.jsx)("input",{type:"text",placeholder:"\u0110\u1ecba \u0111i\u1ec3m",value:e.location,onChange:e=>A(i,"location",e.target.value),className:"mr-2 p-2 border rounded w-2/3 focus:ring focus:ring-green-500",required:!0}),(0,j.jsx)("input",{type:"text",placeholder:"Ghi ch\xfa",value:e.note,onChange:e=>A(i,"note",e.target.value),className:"mr-2 p-2 border rounded w-1/3 focus:ring focus:ring-green-500"}),(0,j.jsx)("button",{type:"button",onClick:()=>(e=>{const i=[...v.dropOffPoints];i.splice(e,1),f({...v,dropOffPoints:i})})(i),className:"text-red-500 hover:text-red-700",children:"X\xf3a"})]},i))),(0,j.jsx)("button",{type:"button",onClick:()=>{f({...v,dropOffPoints:[...v.dropOffPoints,{location:"",note:""}]})},className:"mt-2 text-blue-500 hover:text-blue-700",children:"+ Th\xeam \u0110i\u1ec3m Tr\u1ea3"})]}),(0,j.jsxs)("div",{className:"mb-6",children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Lo\u1ea1i Xe:"}),x?(0,j.jsx)("p",{children:"\u0110ang t\u1ea3i danh s\xe1ch lo\u1ea1i xe..."}):g?(0,j.jsxs)("p",{className:"text-red-500",children:["L\u1ed7i khi t\u1ea3i danh s\xe1ch lo\u1ea1i xe: ",g.message]}):(0,j.jsxs)("select",{name:"busType",value:v.busType,onChange:b,className:"mt-2 p-2 border rounded w-full focus:ring focus:ring-green-500",required:!0,children:[(0,j.jsx)("option",{value:"",children:"Ch\u1ecdn lo\u1ea1i xe"}),null===p||void 0===p?void 0:p.data.map((e=>(0,j.jsx)("option",{value:e._id,children:e.name},e._id)))]})]}),(0,j.jsxs)("div",{className:"mb-6",children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Gi\xe1 V\xe9 C\u01a1 B\u1ea3n:"}),(0,j.jsx)("input",{type:"number",name:"basePrice",value:v.basePrice,onChange:b,placeholder:"Nh\u1eadp gi\xe1 v\xe9 c\u01a1 b\u1ea3n",className:"mt-2 p-2 border rounded w-full focus:ring focus:ring-green-500",required:!0}),(0,j.jsxs)("div",{className:"mt-2 text-sm text-gray-600",children:["Gi\xe1 v\xe9: ",(0,y.v)(v.basePrice)]})]}),(0,j.jsx)("button",{type:"submit",className:"bg-green-500 text-white px-4 py-2 rounded w-full",children:s?"C\u1eadp Nh\u1eadt Chuy\u1ebfn \u0110i":"T\u1ea1o Chuy\u1ebfn \u0110i"})]})};var L=n(23927),D=n(8918),S=n(80349),H=n(6051),O=n(42261),_=n(48677),q=n(59748),F=n(16569),z=n(37490),B=n(1118),G=n(15444);const K=()=>{const{data:e={},isLoading:i,error:n,refetch:r}=(0,l.HP)(),a=e.data||[],[s,{isLoading:o}]=(0,l.Ws)(),[c,{isLoading:x}]=(0,l.A)(),[g,v]=(0,t.useState)(!1),[y,f]=(0,t.useState)(null),[b]=q.A.useForm(),T=[{title:"Ng\u01b0\u1eddi Y\xeau C\u1ea7u",dataIndex:"userId",key:"userId",render:e=>(null===e||void 0===e?void 0:e.fullName)||"N/A"},{title:"Kh\u1edfi H\xe0nh",dataIndex:"departureLocation",key:"departureLocation",render:e=>(null===e||void 0===e?void 0:e.name)||"N/A"},{title:"\u0110i\u1ec3m \u0110\u1ebfn",dataIndex:"arrivalLocation",key:"arrivalLocation",render:e=>(null===e||void 0===e?void 0:e.name)||"N/A"},{title:"Th\u1eddi Gian",dataIndex:"preferredDepartureTime",key:"preferredDepartureTime",render:e=>e?new Date(e).toLocaleString():"N/A"},{title:"S\u1ed1 Gh\u1ebf",dataIndex:"seatNumbers",key:"seatNumbers",render:e=>(null===e||void 0===e?void 0:e.join(", "))||"N/A"},{title:"Tr\u1ea1ng Th\xe1i",dataIndex:"status",key:"status",render:e=>(0,j.jsx)(z.A,{status:"Pending"===e?"processing":"Approved"===e?"success":"error",text:"Pending"===e?"\u0110ang Ch\u1edd":"Approved"===e?"\u0110\xe3 Duy\u1ec7t":"\u0110\xe3 T\u1eeb Ch\u1ed1i"})},{title:"H\xe0nh \u0110\u1ed9ng",key:"actions",render:e=>(0,j.jsx)("div",{className:"flex gap-2",children:"Pending"===e.status&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(d.Ay,{type:"primary",onClick:()=>{return i=e._id,f(i),void v(!0);var i},loading:o,disabled:o||x,children:"Duy\u1ec7t"}),(0,j.jsx)(u.A,{title:"B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n t\u1eeb ch\u1ed1i y\xeau c\u1ea7u n\xe0y?",onConfirm:()=>(async e=>{try{await c({requestId:e,reason:"Kh\xf4ng ph\xf9 h\u1ee3p v\u1edbi l\u1ecbch tr\xecnh"}).unwrap(),F.Ay.success("Y\xeau c\u1ea7u \u0111\xe3 b\u1ecb t\u1eeb ch\u1ed1i!"),r()}catch(n){var i;F.Ay.error((null===n||void 0===n||null===(i=n.data)||void 0===i?void 0:i.message)||"T\u1eeb ch\u1ed1i y\xeau c\u1ea7u th\u1ea5t b\u1ea1i.")}})(e._id),okText:"T\u1eeb Ch\u1ed1i",cancelText:"H\u1ee7y",children:(0,j.jsx)(d.Ay,{type:"danger",loading:x,disabled:o||x,children:"T\u1eeb Ch\u1ed1i"})})]})})}];return(0,j.jsxs)("div",{className:"container mx-auto p-6 bg-white rounded-md shadow-md",children:[i?(0,j.jsx)("div",{className:"flex justify-center py-2",children:(0,j.jsx)(p.A,{tip:"\u0110ang t\u1ea3i danh s\xe1ch y\xeau c\u1ea7u...",size:"large"})}):n?(0,j.jsx)(O.A,{message:"C\xf3 l\u1ed7i x\u1ea3y ra khi t\u1ea3i danh s\xe1ch y\xeau c\u1ea7u",description:n.message,type:"error",showIcon:!0}):0===a.length?(0,j.jsx)("p",{className:"text-center text-gray-500",children:"Kh\xf4ng c\xf3 y\xeau c\u1ea7u n\xe0o."}):(0,j.jsx)(h.A,{columns:T,dataSource:a,rowKey:e=>e._id,pagination:{pageSize:5,showSizeChanger:!0,pageSizeOptions:["5","10","20"]}}),(0,j.jsx)(m.A,{title:"Nh\u1eadp th\xf4ng tin chuy\u1ebfn \u0111i",visible:g,onCancel:()=>v(!1),onOk:()=>b.submit(),okText:"X\xe1c Nh\u1eadn",cancelText:"H\u1ee7y",children:(0,j.jsxs)(q.A,{form:b,layout:"vertical",onFinish:async e=>{try{const i={basePrice:e.basePrice,pickupPoints:e.pickupPoints.split(",").map((e=>({time:"",location:e.trim(),note:""}))),dropOffPoints:e.dropOffPoints.split(",").map((e=>({time:"",location:e.trim(),note:""})))};console.log("Sending approve request with ID:",y),console.log("Sending approve request with values:",i);const n=await s({requestId:y,...i}).unwrap();console.log("Approve response:",n),F.Ay.success("Y\xeau c\u1ea7u \u0111\xe3 \u0111\u01b0\u1ee3c duy\u1ec7t th\xe0nh c\xf4ng!"),v(!1),b.resetFields(),r()}catch(n){var i;console.error("Approve error:",n),F.Ay.error((null===n||void 0===n||null===(i=n.data)||void 0===i?void 0:i.message)||"Duy\u1ec7t y\xeau c\u1ea7u th\u1ea5t b\u1ea1i.")}},children:[(0,j.jsx)(q.A.Item,{label:"Gi\xe1 V\xe9 C\u01a1 B\u1ea3n",name:"basePrice",rules:[{required:!0,message:"Vui l\xf2ng nh\u1eadp gi\xe1 v\xe9 c\u01a1 b\u1ea3n!"}],children:(0,j.jsx)(B.A,{min:0,style:{width:"100%"},placeholder:"Nh\u1eadp gi\xe1 v\xe9"})}),(0,j.jsx)(q.A.Item,{label:"\u0110i\u1ec3m \u0110\xf3n",name:"pickupPoints",rules:[{required:!0,message:"Vui l\xf2ng nh\u1eadp \u0111i\u1ec3m \u0111\xf3n!"}],children:(0,j.jsx)(G.A.TextArea,{rows:2,placeholder:"Nh\u1eadp danh s\xe1ch \u0111i\u1ec3m \u0111\xf3n (ng\u0103n c\xe1ch b\u1edfi d\u1ea5u ph\u1ea9y)"})}),(0,j.jsx)(q.A.Item,{label:"\u0110i\u1ec3m Tr\u1ea3",name:"dropOffPoints",rules:[{required:!0,message:"Vui l\xf2ng nh\u1eadp \u0111i\u1ec3m tr\u1ea3!"}],children:(0,j.jsx)(G.A.TextArea,{rows:2,placeholder:"Nh\u1eadp danh s\xe1ch \u0111i\u1ec3m tr\u1ea3 (ng\u0103n c\xe1ch b\u1edfi d\u1ea5u ph\u1ea9y)"})})]})})]})},{Title:M}=L.A,{TabPane:X}=D.A,Y=()=>{const e=(0,r.d4)((e=>{var i;return null===(i=e.user.userInfo)||void 0===i?void 0:i.companyId})),[i,n]=(0,t.useState)(!1),[s,o]=(0,t.useState)(null),[c,h]=(0,t.useState)("add"),[m,x]=(0,t.useState)("active"),{data:g={},isLoading:v,error:y,refetch:f}=(0,a.CI)(e,{skip:!e}),b=g.trips||[],{activeTrips:N,completedTrips:k}=(0,t.useMemo)((()=>{const e=[],i=[];return b.forEach((n=>{"Completed"===n.status?i.push(n):e.push(n)})),{activeTrips:e,completedTrips:i}}),[b]),{data:C={},isLoading:w}=(0,l.HP)(),A=C.data||[],[P,{isLoading:L}]=(0,a.D1)(),q=(0,t.useCallback)(((e,i,n)=>{S.Ay[e]({message:i,description:n})}),[]),F=(0,t.useCallback)((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;o(e?e._id:null),h(e?"edit":"add"),n(!0)}),[]),z=(0,t.useCallback)((function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1?arguments[1]:void 0;n(!1),o(null),h("add"),e&&q("success","Th\xe0nh c\xf4ng",i),f()}),[q,f]);return(0,j.jsxs)("div",{className:"container mx-auto p-8 bg-white shadow-md rounded-md",children:[(0,j.jsxs)("div",{className:"header flex justify-between items-center mb-6",children:[(0,j.jsx)(M,{level:3,className:"text-gray-800",children:"Qu\u1ea3n L\xfd Chuy\u1ebfn \u0110i"}),(0,j.jsxs)(H.A,{size:"large",children:["active"===m&&(0,j.jsx)(u.A,{title:"B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n x\xf3a t\u1ea5t c\u1ea3 c\xe1c chuy\u1ebfn \u0111i \u0111\xe3 qu\xe1 h\u1ea1n?",onConfirm:async()=>{try{const e=await P().unwrap();q("success","Th\xe0nh c\xf4ng",e.message||"C\xe1c chuy\u1ebfn \u0111i \u0111\xe3 qu\xe1 h\u1ea1n \u0111\xe3 \u0111\u01b0\u1ee3c x\xf3a th\xe0nh c\xf4ng."),f()}catch(y){var e;const n=(null===y||void 0===y||null===(e=y.data)||void 0===e?void 0:e.message)||"C\xf3 l\u1ed7i x\u1ea3y ra khi x\xf3a c\xe1c chuy\u1ebfn \u0111i \u0111\xe3 qu\xe1 h\u1ea1n.";q("error","L\u1ed7i",n)}},okText:"X\xf3a",cancelText:"H\u1ee7y",children:(0,j.jsx)(d.Ay,{type:"primary",danger:!0,loading:L,style:{backgroundColor:"#ff4d4f",borderColor:"#ff4d4f"},children:"X\xf3a Chuy\u1ebfn \u0110i Qu\xe1 H\u1ea1n"})}),"active"===m&&(0,j.jsx)(d.Ay,{type:"primary",onClick:()=>F(),children:"T\u1ea1o Chuy\u1ebfn \u0110i"})]})]}),(0,j.jsx)("div",{className:"content",children:(0,j.jsxs)(D.A,{activeKey:m,onChange:e=>{x(e)},type:"card",children:[(0,j.jsx)(X,{tab:`Chuy\u1ebfn \u0111i \u0111ang ho\u1ea1t \u0111\u1ed9ng (${N.length})`,children:v?(0,j.jsx)("div",{className:"loading-spinner flex justify-center py-10",children:(0,j.jsx)(p.A,{tip:"\u0110ang t\u1ea3i danh s\xe1ch chuy\u1ebfn \u0111i...",size:"large"})}):y?(0,j.jsx)(O.A,{message:"C\xf3 l\u1ed7i x\u1ea3y ra khi t\u1ea3i danh s\xe1ch chuy\u1ebfn \u0111i",description:y.message,type:"error",showIcon:!0,className:"error-alert"}):(0,j.jsx)(T,{trips:N,openDrawer:F,hideAddButton:i,showNotification:q,refetch:f})},"active"),(0,j.jsx)(X,{tab:`Chuy\u1ebfn \u0111i \u0111\xe3 ho\xe0n th\xe0nh (${k.length})`,children:v?(0,j.jsx)("div",{className:"loading-spinner flex justify-center py-10",children:(0,j.jsx)(p.A,{tip:"\u0110ang t\u1ea3i danh s\xe1ch chuy\u1ebfn \u0111i...",size:"large"})}):y?(0,j.jsx)(O.A,{message:"C\xf3 l\u1ed7i x\u1ea3y ra khi t\u1ea3i danh s\xe1ch chuy\u1ebfn \u0111i",description:y.message,type:"error",showIcon:!0,className:"error-alert"}):(0,j.jsx)(T,{trips:k,openDrawer:F,hideAddButton:i,showNotification:q,refetch:f,isCompleted:!0})},"completed"),(0,j.jsx)(X,{tab:`Y\xeau c\u1ea7u m\u1edf chuy\u1ebfn \u0111i (${w?"...":A.length})`,children:(0,j.jsx)(K,{companyId:e})},"requests")]})}),(0,j.jsx)(_.A,{title:s?"Ch\u1ec9nh S\u1eeda Chuy\u1ebfn \u0110i":"Th\xeam Chuy\u1ebfn \u0110i M\u1edbi",width:500,onClose:()=>z(!1),open:i,destroyOnClose:!0,children:(0,j.jsx)(I,{tripId:s,closeDrawer:e=>z(!0,e),trips:b,formMode:c,showNotification:q})})]})}},10254:(e,i,n)=>{n.d(i,{D:()=>a,v:()=>s});var t=n(34348),r=n.n(t);const a={parseUTCTimeForForm:e=>e?new Date(e):new Date,formatTimeForServer:e=>e?r()(e).utc().format():null,formatDisplayTime:e=>e?r()(e).tz("Asia/Ho_Chi_Minh").format("DD/MM/YYYY HH:mm"):""},s=e=>e?new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e):"0 VND"}}]);
//# sourceMappingURL=386.14a2e402.chunk.js.map