"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[982],{56982:(e,t,s)=>{s.r(t),s.d(t,{default:()=>x});var n=s(65043),r=s(73216),l=s(60184),a=s(3836),i=(s(48970),s(75995)),o=s(70579);const c=e=>{let{endTime:t,onTimeout:s}=e;const[r,l]=(0,n.useState)(0);(0,n.useEffect)((()=>{const e=new Date(t).getTime(),n=()=>Math.max(0,Math.floor((e-Date.now())/1e3));l(n());const r=setInterval((()=>{l((e=>{const t=n();return t<=0&&(clearInterval(r),s()),t}))}),1e3);return()=>clearInterval(r)}),[t,s]);const a=String(Math.floor(r/60)).padStart(2,"0"),i=String(r%60).padStart(2,"0");return(0,o.jsxs)("div",{className:"w-full text-center font-bold mb-8 p-4 rounded-lg shadow-lg flex flex-col items-center",style:{background:"linear-gradient(135deg, #3a8dff, #1e40af)",color:"white",borderRadius:"8px",boxShadow:"0 6px 12px rgba(0, 0, 0, 0.2)"},children:[(0,o.jsx)("p",{className:"text-lg tracking-wide",style:{marginBottom:"8px"},children:"Th\u1eddi gian thanh to\xe1n c\xf2n l\u1ea1i"}),(0,o.jsxs)("div",{className:"bg-white text-red-600 font-extrabold text-5xl px-6 py-2 rounded-md shadow-md inline-block",style:{boxShadow:"0 4px 15px rgba(0, 0, 0, 0.1)",fontFamily:"monospace"},children:[a,":",i]})]})};var d=s(85627);const h=e=>{let{onSelectVoucher:t}=e;const{data:s,isLoading:n,isError:r}=(0,d.K0)();return(0,o.jsxs)("div",{className:"mb-6",children:[(0,o.jsx)("h3",{className:"text-2xl font-semibold text-gray-800 mb-6",children:"Voucher c\u1ee7a b\u1ea1n"}),n?(0,o.jsx)("p",{children:"\u0110ang t\u1ea3i danh s\xe1ch voucher..."}):r?(0,o.jsx)("p",{className:"text-red-500",children:"Kh\xf4ng th\u1ec3 t\u1ea3i danh s\xe1ch voucher. Vui l\xf2ng th\u1eed l\u1ea1i."}):(0,o.jsx)("ul",{className:"space-y-4",children:null===s||void 0===s?void 0:s.map((e=>(0,o.jsxs)("li",{className:"flex items-center p-4 border border-gray-200 rounded-lg shadow-md bg-white hover:bg-gray-50 cursor-pointer transition duration-200",onClick:()=>t(e),children:[(0,o.jsx)("div",{className:"flex-shrink-0 text-blue-500 mr-4",children:(0,o.jsx)(l.wJQ,{size:24})}),(0,o.jsxs)("div",{className:"flex-1",children:[(0,o.jsxs)("p",{className:"text-lg font-medium text-gray-700 mb-1",children:["M\xe3: ",e.code]}),(0,o.jsxs)("div",{className:"flex items-center text-sm text-gray-500 space-x-4",children:[(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)(l.lWC,{className:"mr-1 text-yellow-500"}),(0,o.jsxs)("span",{children:["Gi\u1ea3m gi\xe1: ",e.discount,"%"]})]}),(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)(l.bfZ,{className:"mr-1 text-red-500"}),(0,o.jsxs)("span",{children:["HSD: ",new Date(e.expiryDate).toLocaleDateString("vi-VN")]})]})]})]})]},e._id)))})]})},x=()=>{const e=(0,r.zy)(),t=(0,r.Zp)(),[s,d]=(0,n.useState)(null),{selectedSeats:x,totalPrice:m,trip:g,bookingId:u,expiryTime:b}=e.state||{},[p,j]=(0,n.useState)(null),[y,{isLoading:f,isError:v,data:N,isSuccess:w}]=(0,a.oN)(),[k,S]=(0,n.useState)(!1),[C,V]=(0,n.useState)(!1),[T,O]=(0,n.useState)({open:!1,message:"",severity:"success"}),D=s?m-m*s.discount/100:m,B=function(e){O({open:!0,message:e,severity:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success"})};(0,n.useEffect)((()=>{w&&"OnBoard"===p&&(B("\u0110\u1eb7t ch\u1ed7 th\xe0nh c\xf4ng! B\u1ea1n s\u1ebd thanh to\xe1n khi l\xean xe."),t("/user/ticket-buy"))}),[w,p,t]);return(0,o.jsxs)("div",{className:"container mx-auto p-6 bg-gray-50 min-h-screen",children:[(0,o.jsx)(c,{endTime:b,onTimeout:()=>{V(!0)}}),(0,o.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,o.jsxs)("div",{className:"lg:col-span-2 bg-white p-8 rounded-xl shadow-lg",children:[(0,o.jsx)("h1",{className:"text-2xl font-semibold text-gray-800 mb-6",children:"Ph\u01b0\u01a1ng th\u1ee9c thanh to\xe1n"}),(0,o.jsxs)("div",{className:"mb-6 border rounded-lg p-6 flex items-center cursor-pointer hover:shadow-md "+("Online"===p?"border-blue-500 bg-blue-50":"border-gray-300"),onClick:()=>j("Online"),children:[(0,o.jsx)(l.Acq,{className:"text-3xl text-blue-500 mr-4"}),(0,o.jsxs)("div",{children:[(0,o.jsx)("input",{type:"radio",id:"qr",name:"payment",className:"mr-3 mt-1",checked:"Online"===p,onChange:()=>j("Online")}),(0,o.jsx)("label",{htmlFor:"qr",className:"text-lg font-medium text-gray-700",children:"QR chuy\u1ec3n kho\u1ea3n / V\xed \u0111i\u1ec7n t\u1eed"})]})]}),(0,o.jsxs)("div",{className:"mb-6 border rounded-lg p-6 flex items-center cursor-pointer hover:shadow-md "+("OnBoard"===p?"border-green-500 bg-green-50":"border-gray-300"),onClick:()=>j("OnBoard"),children:[(0,o.jsx)(l.dZW,{className:"text-3xl text-green-500 mr-4"}),(0,o.jsxs)("div",{children:[(0,o.jsx)("input",{type:"radio",id:"onboard",name:"payment",className:"mr-3 mt-1",checked:"OnBoard"===p,onChange:()=>j("OnBoard")}),(0,o.jsx)("label",{htmlFor:"onboard",className:"text-lg font-medium text-gray-700",children:"Thanh to\xe1n khi l\xean xe"})]})]}),v&&(0,o.jsx)("p",{className:"text-red-500 mt-4",children:"\u0110\xe3 c\xf3 l\u1ed7i x\u1ea3y ra. Vui l\xf2ng th\u1eed l\u1ea1i."}),!w&&(0,o.jsxs)("button",{className:"w-full bg-yellow-500 text-white font-semibold py-3 rounded-lg hover:bg-yellow-600 flex items-center justify-center mt-4",onClick:async()=>{if(!p)return void B("Vui l\xf2ng ch\u1ecdn ph\u01b0\u01a1ng th\u1ee9c thanh to\xe1n","error");if(!u)return void B("D\u1eef li\u1ec7u kh\xf4ng h\u1ee3p l\u1ec7","error");const e={bookingId:u,paymentMethod:p,voucherCode:(null===s||void 0===s?void 0:s.code)||null};try{const t=await y(e).unwrap();"Online"===p&&(B("\u0110\u1eb7t ch\u1ed7 th\xe0nh c\xf4ng! Vui l\xf2ng nh\u1ea5n v\xe0o li\xean k\u1ebft \u0111\u1ec3 thanh to\xe1n...","success"),setTimeout((()=>{window.open(t.data.paymentLink,"_self")}),2e3))}catch(t){console.error("L\u1ed7i khi \u0111\u1eb7t ch\u1ed7:",t),B("C\xf3 l\u1ed7i x\u1ea3y ra khi \u0111\u1eb7t ch\u1ed7. Vui l\xf2ng th\u1eed l\u1ea1i.","error")}},disabled:f,children:[(0,o.jsx)(l.tVd,{className:"mr-2"})," ",f?"\u0110ang \u0111\u1eb7t ch\u1ed7...":"\u0110\u1eb7t ch\u1ed7"]})]}),(0,o.jsxs)("div",{className:"bg-white p-8 rounded-xl shadow-lg",children:[(0,o.jsx)("h2",{className:"text-2xl font-semibold text-gray-800 mb-6",children:"Th\xf4ng tin thanh to\xe1n"}),(0,o.jsx)("button",{className:"w-full bg-blue-500 text-white font-semibold py-2 rounded-lg hover:bg-blue-600 transition duration-300 mb-4",onClick:()=>S(!k),children:k?"\u1ea8n voucher":"Hi\u1ec3n th\u1ecb voucher"}),(0,o.jsx)("div",{className:"transition-all duration-300 ease-in-out transform "+(k?"opacity-100 translate-y-0":"opacity-0 -translate-y-4 pointer-events-none"),children:k&&(0,o.jsx)(h,{onSelectVoucher:e=>{d(e),S(!1)}})}),s&&(0,o.jsxs)("div",{className:"mt-4 p-4 bg-gray-100 border border-gray-200 rounded-lg",children:[(0,o.jsxs)("p",{className:"text-sm text-gray-600",children:["Voucher \xe1p d\u1ee5ng: ",(0,o.jsx)("span",{className:"font-semibold",children:s.code})]}),(0,o.jsxs)("p",{className:"text-sm text-gray-600",children:["Gi\u1ea3m gi\xe1: ",(0,o.jsxs)("span",{className:"font-semibold",children:[s.discount,"%"]})]})]}),(0,o.jsxs)("div",{className:"mt-6 p-6 border rounded-lg shadow-sm bg-gray-100 flex items-center justify-between",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h2",{className:"text-lg font-semibold text-gray-700 mb-2",children:"T\u1ed5ng ti\u1ec1n"}),(0,o.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:D?`${D.toLocaleString("vi-VN")} VND`:"Ch\u01b0a c\xf3 th\xf4ng tin gi\xe1"})]}),(0,o.jsx)(l.dZW,{className:"text-4xl text-blue-600"})]})]})]}),(0,o.jsx)(i.A,{open:T.open,onClose:()=>{O({...T,open:!1})},severity:T.severity,message:T.message})]})}}}]);
//# sourceMappingURL=982.b0de004c.chunk.js.map