"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[717],{8098:(e,t,r)=>{r.r(t),r.d(t,{default:()=>L});var n=r(5043),i=r(3216),s=r(5868),a=r(254),l=r(3057),o=r(5962),c=r(7248);var u=r(6728),d=r(6170),m=r(9358),h=r(3161),v=r(6794),p=r(3820),g=r(3880),x=r(5641);function b(e){var t;return!!(e.enter||e.enterFrom||e.enterTo||e.leave||e.leaveFrom||e.leaveTo)||(null!=(t=e.as)?t:C)!==n.Fragment||1===n.Children.count(e.children)}let f=(0,n.createContext)(null);f.displayName="TransitionContext";var N,w=((N=w||{}).Visible="visible",N.Hidden="hidden",N);let j=(0,n.createContext)(null);function T(e){return"children"in e?T(e.children):e.current.filter((e=>{let{el:t}=e;return null!==t.current})).filter((e=>{let{state:t}=e;return"visible"===t})).length>0}function y(e,t){let r=(0,u.Y)(e),i=(0,n.useRef)([]),s=function(){let e=(0,n.useRef)(!1);return(0,c.s)((()=>(e.current=!0,()=>{e.current=!1})),[]),e}(),a=(0,l.L)(),d=(0,o._)((function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:x.mK.Hidden,n=i.current.findIndex((t=>{let{el:r}=t;return r===e}));-1!==n&&((0,g.Y)(t,{[x.mK.Unmount](){i.current.splice(n,1)},[x.mK.Hidden](){i.current[n].state="hidden"}}),a.microTask((()=>{var e;!T(i)&&s.current&&(null==(e=r.current)||e.call(r))})))})),m=(0,o._)((e=>{let t=i.current.find((t=>{let{el:r}=t;return r===e}));return t?"visible"!==t.state&&(t.state="visible"):i.current.push({el:e,state:"visible"}),()=>d(e,x.mK.Unmount)})),h=(0,n.useRef)([]),v=(0,n.useRef)(Promise.resolve()),p=(0,n.useRef)({enter:[],leave:[]}),b=(0,o._)(((e,r,n)=>{h.current.splice(0),t&&(t.chains.current[r]=t.chains.current[r].filter((t=>{let[r]=t;return r!==e}))),null==t||t.chains.current[r].push([e,new Promise((e=>{h.current.push(e)}))]),null==t||t.chains.current[r].push([e,new Promise((e=>{Promise.all(p.current[r].map((e=>{let[t,r]=e;return r}))).then((()=>e()))}))]),"enter"===r?v.current=v.current.then((()=>null==t?void 0:t.wait.current)).then((()=>n(r))):n(r)})),f=(0,o._)(((e,t,r)=>{Promise.all(p.current[t].splice(0).map((e=>{let[t,r]=e;return r}))).then((()=>{var e;null==(e=h.current.shift())||e()})).then((()=>r(t)))}));return(0,n.useMemo)((()=>({children:i,register:m,unregister:d,onStart:b,onStop:f,wait:v,chains:p})),[m,d,i,b,f,p,v])}j.displayName="NestingContext";let C=n.Fragment,P=x.Ac.RenderStrategy;let D=(0,x.FX)((function(e,t){let{show:r,appear:i=!1,unmount:s=!0,...a}=e,l=(0,n.useRef)(null),u=b(e),h=(0,m.P)(...u?[l,t]:null===t?[]:[t]);(0,d.g)();let p=(0,v.O_)();if(void 0===r&&null!==p&&(r=(p&v.Uw.Open)===v.Uw.Open),void 0===r)throw new Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[g,N]=(0,n.useState)(r?"visible":"hidden"),w=y((()=>{r||N("hidden")})),[C,D]=(0,n.useState)(!0),S=(0,n.useRef)([r]);(0,c.s)((()=>{!1!==C&&S.current[S.current.length-1]!==r&&(S.current.push(r),D(!1))}),[S,r]);let R=(0,n.useMemo)((()=>({show:r,appear:i,initial:C})),[r,i,C]);(0,c.s)((()=>{r?N("visible"):!T(w)&&null!==l.current&&N("hidden")}),[r,w]);let F={unmount:s},_=(0,o._)((()=>{var t;C&&D(!1),null==(t=e.beforeEnter)||t.call(e)})),k=(0,o._)((()=>{var t;C&&D(!1),null==(t=e.beforeLeave)||t.call(e)}));return n.createElement(j.Provider,{value:w},n.createElement(f.Provider,{value:R},(0,x.XX)({ourProps:{...F,as:n.Fragment,children:n.createElement(E,{ref:h,...F,...a,beforeEnter:_,beforeLeave:k})},theirProps:{},defaultTag:n.Fragment,features:P,visible:"visible"===g,name:"Transition"})))})),E=(0,x.FX)((function(e,t){var r,i;let{transition:s=!0,beforeEnter:a,afterEnter:l,beforeLeave:u,afterLeave:N,enter:w,enterFrom:D,enterTo:E,entered:S,leave:R,leaveFrom:F,leaveTo:_,...k}=e,[L,H]=(0,n.useState)(null),O=(0,n.useRef)(null),K=b(e),U=(0,m.P)(...K?[O,t,H]:null===t?[]:[t]),A=null==(r=k.unmount)||r?x.mK.Unmount:x.mK.Hidden,{show:X,appear:V,initial:Y}=function(){let e=(0,n.useContext)(f);if(null===e)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}(),[G,M]=(0,n.useState)(X?"visible":"hidden"),B=function(){let e=(0,n.useContext)(j);if(null===e)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}(),{register:z,unregister:I}=B;(0,c.s)((()=>z(O)),[z,O]),(0,c.s)((()=>{if(A===x.mK.Hidden&&O.current)return X&&"visible"!==G?void M("visible"):(0,g.Y)(G,{hidden:()=>I(O),visible:()=>z(O)})}),[G,O,z,I,X,A]);let q=(0,d.g)();(0,c.s)((()=>{if(K&&q&&"visible"===G&&null===O.current)throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")}),[O,G,q,K]);let Z=Y&&!V,J=V&&X&&Y,Q=(0,n.useRef)(!1),W=y((()=>{Q.current||(M("hidden"),I(O))}),B),$=(0,o._)((e=>{Q.current=!0;let t=e?"enter":"leave";W.onStart(O,t,(e=>{"enter"===e?null==a||a():"leave"===e&&(null==u||u())}))})),ee=(0,o._)((e=>{let t=e?"enter":"leave";Q.current=!1,W.onStop(O,t,(e=>{"enter"===e?null==l||l():"leave"===e&&(null==N||N())})),"leave"===t&&!T(W)&&(M("hidden"),I(O))}));(0,n.useEffect)((()=>{K&&s||($(X),ee(X))}),[X,K,s]);let te=!(!s||!K||!q||Z),[,re]=(0,h.p)(te,L,X,{start:$,end:ee}),ne=(0,x.oE)({ref:U,className:(null==(i=(0,p.x)(k.className,J&&w,J&&D,re.enter&&w,re.enter&&re.closed&&D,re.enter&&!re.closed&&E,re.leave&&R,re.leave&&!re.closed&&F,re.leave&&re.closed&&_,!re.transition&&X&&S))?void 0:i.trim())||void 0,...(0,h.B)(re)}),ie=0;return"visible"===G&&(ie|=v.Uw.Open),"hidden"===G&&(ie|=v.Uw.Closed),re.enter&&(ie|=v.Uw.Opening),re.leave&&(ie|=v.Uw.Closing),n.createElement(j.Provider,{value:W},n.createElement(v.El,{value:ie},(0,x.XX)({ourProps:ne,theirProps:k,defaultTag:C,features:P,visible:"visible"===G,name:"Transition.Child"})))})),S=(0,x.FX)((function(e,t){let r=null!==(0,n.useContext)(f),i=null!==(0,v.O_)();return n.createElement(n.Fragment,null,!r&&i?n.createElement(D,{ref:t,...e}):n.createElement(E,{ref:t,...e}))})),R=Object.assign(D,{Child:S,Root:D});var F=r(579);const _=e=>{var t,r;let{trip:l,isOpen:o,onToggle:c}=e;const[u,d]=(0,n.useState)([]),m=(0,i.Zp)(),{data:h,isLoading:v}=(0,s.BX)(l._id,{skip:!o}),p=e=>!e.isAvailable,g=u.length*l.basePrice;return(0,F.jsxs)("div",{className:"bg-white rounded-lg shadow-lg mb-6 p-4 hover:shadow-xl transition-shadow duration-300",children:[(0,F.jsxs)("div",{className:"flex justify-between",children:[(0,F.jsxs)("div",{className:"flex items-start",children:[(0,F.jsxs)("div",{className:"relative",children:[(0,F.jsx)("img",{src:l.busType.image||"https://static.vexere.com/production/images/1702527338553.jpeg",alt:"Bus",className:"w-28 h-28 object-cover rounded-lg"}),(0,F.jsx)("div",{className:"absolute top-1 left-1 bg-green-500 text-white text-xs px-2 py-1 rounded",children:"X\xe1c nh\u1eadn t\u1ee9c th\xec"})]}),(0,F.jsxs)("div",{className:"ml-4",children:[(0,F.jsx)("h3",{className:"font-semibold text-lg",children:l.busType.name}),(0,F.jsxs)("p",{className:"text-sm text-gray-600",children:[l.busType.seats," ch\u1ed7"]}),(0,F.jsxs)("div",{className:"mt-2 text-sm space-y-1",children:[(0,F.jsxs)("div",{children:["Gi\u1edd \u0111i: ",new Date(l.departureTime).toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"})]}),(0,F.jsxs)("div",{children:["N\u01a1i \u0111i: ",l.departureLocation.name]}),(0,F.jsxs)("div",{children:["N\u01a1i \u0111\u1ebfn: ",l.arrivalLocation.name]})]}),(0,F.jsxs)("p",{className:"mt-2 text-green-600",children:["C\xf2n ",l.availableSeats," ch\u1ed7 tr\u1ed1ng"]})]})]}),(0,F.jsxs)("div",{className:"text-right",children:[(0,F.jsxs)("p",{className:"text-xl font-bold text-blue-600 mb-2",children:["T\u1eeb ",(0,a.v)(l.basePrice)," VND"]}),(0,F.jsx)("button",{onClick:c,className:"bg-yellow-500 text-white px-4 py-2 rounded-lg hover:bg-yellow-600 transition duration-300",children:o?"\u1ea8n chi ti\u1ebft":"Ch\u1ecdn chuy\u1ebfn"}),(0,F.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"KH\xd4NG C\u1ea6N THANH TO\xc1N TR\u01af\u1edaC"})]})]}),(0,F.jsx)(R,{show:o,as:"div",enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:o&&(0,F.jsxs)("div",{className:"border-t mt-4 pt-4",children:[(0,F.jsxs)("div",{className:"flex justify-between",children:[(0,F.jsxs)("div",{className:"w-1/3",children:[(0,F.jsx)("h4",{className:"font-medium mb-3",children:"Ch\xfa th\xedch:"}),(0,F.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,F.jsxs)("div",{className:"flex items-center",children:[(0,F.jsx)("div",{className:"w-4 h-4 border border-gray-300 bg-white mr-2"}),"Gh\u1ebf kh\xf4ng b\xe1n"]}),(0,F.jsxs)("div",{className:"flex items-center",children:[(0,F.jsx)("div",{className:"w-4 h-4 bg-green-500 mr-2"}),"\u0110ang ch\u1ecdn"]}),(0,F.jsxs)("div",{className:"flex items-center",children:[(0,F.jsx)("div",{className:"w-4 h-4 border border-green-500 bg-green-100 mr-2"}),"Gh\u1ebf c\xf2n tr\u1ed1ng"]}),(0,F.jsxs)("div",{className:"flex items-center",children:[(0,F.jsx)("div",{className:"w-4 h-4 bg-red-500 mr-2"}),"Gh\u1ebf \u0111\xe3 \u0111\u1eb7t"]})]})]}),(0,F.jsxs)("div",{className:"w-2/3",children:[(0,F.jsx)("h4",{className:"font-medium mb-3 text-center",children:"Th\xf4ng tin gh\u1ebf ng\u1ed3i:"}),v?(0,F.jsx)("div",{className:"text-center py-4",children:"\u0110ang t\u1ea3i..."}):(0,F.jsx)("div",{className:"grid grid-cols-5 gap-2",children:null===h||void 0===h||null===(t=h.data)||void 0===t||null===(r=t.lower)||void 0===r?void 0:r.map((e=>{return(0,F.jsx)("button",{onClick:()=>{return!p(e)&&(t=e.seatNumber,void(u.includes(t)?d(u.filter((e=>e!==t))):d([...u,t])));var t},disabled:p(e),className:"w-12 h-12 rounded-lg text-center text-sm font-semibold cursor-pointer\n                          "+(t=e.seatNumber,u.includes(t)?"bg-green-500 text-white":p(e)?"bg-red-500 text-white":"bg-green-100 border-2 border-green-500"),children:e.seatNumber},e.seatNumber);var t}))})]})]}),(0,F.jsxs)("div",{className:"mt-4 flex justify-between items-center border-t pt-4",children:[(0,F.jsxs)("div",{className:"text-sm",children:["Gh\u1ebf \u0111\xe3 ch\u1ecdn: ",u.join(", ")]}),(0,F.jsxs)("div",{className:"text-lg font-bold",children:["T\u1ed5ng c\u1ed9ng: ",(0,a.v)(g)," VND"]}),(0,F.jsx)("button",{onClick:()=>{m("/bookingconfirmation",{state:{selectedSeats:u,totalPrice:g,trip:l}})},className:"bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600 transition duration-300",children:"Ti\u1ebfp t\u1ee5c"})]})]})})]})};var k=r(6181);const L=e=>{let{filters:t={}}=e;const r=(0,i.zy)(),a=new URLSearchParams(r.search),l=a.get("departureLocation"),o=a.get("arrivalLocation"),c=a.get("departureDate"),u=a.get("returnDate"),d=a.get("ticketCount"),[m,h]=(0,n.useState)([]),[v,p]=(0,n.useState)([]),[g,x]=(0,n.useState)(!0),[b,f]=(0,n.useState)([]),[N,w]=(0,n.useState)(0),[j,T]=(0,n.useState)(null),{data:y,error:C,isLoading:P}=(0,s.pg)({departureLocation:l,arrivalLocation:o,departureDate:c,returnDate:u,ticketCount:d});if((0,n.useEffect)((()=>{var e;null!==y&&void 0!==y&&null!==(e=y.data)&&void 0!==e&&e.departureTrips&&(p(y.data.departureTrips),h(y.data.departureTrips))}),[y]),(0,n.useEffect)((()=>{x(!0);const e=setTimeout((()=>{(()=>{let e=[...v];"low"===t.priceRange?e=e.filter((e=>e.basePrice<2e5)):"medium"===t.priceRange?e=e.filter((e=>e.basePrice>=2e5&&e.basePrice<=5e5)):"high"===t.priceRange&&(e=e.filter((e=>e.basePrice>5e5))),t.busOperator&&(e=e.filter((e=>{var r;return(null===(r=e.busType)||void 0===r?void 0:r.name)===t.busOperator}))),"morning"===t.departureTimeRange?e=e.filter((e=>{const t=new Date(e.departureTime).getHours();return t>=6&&t<12})):"afternoon"===t.departureTimeRange&&(e=e.filter((e=>{const t=new Date(e.departureTime).getHours();return t>=12&&t<18}))),"priceAsc"===t.sort?e.sort(((e,t)=>e.basePrice-t.basePrice)):"priceDesc"===t.sort?e.sort(((e,t)=>t.basePrice-e.basePrice)):"earliest"===t.sort?e.sort(((e,t)=>new Date(e.departureTime)-new Date(t.departureTime))):"latest"===t.sort&&e.sort(((e,t)=>new Date(t.departureTime)-new Date(e.departureTime))),h(e),x(!1)})()}),500);return()=>clearTimeout(e)}),[t,v]),!l||!o||!c)return(0,F.jsx)("div",{children:"Thi\u1ebfu th\xf4ng tin t\xecm ki\u1ebfm. Vui l\xf2ng th\u1eed l\u1ea1i."});if(g||P)return(0,F.jsx)("div",{className:"container mx-auto py-8",children:(0,F.jsx)(k.A,{})});if(C)return(0,F.jsxs)("div",{children:["Kh\xf4ng t\xecm th\u1ea5y chuy\u1ebfn xe. L\u1ed7i: ",C.message]});if(0===m.length)return(0,F.jsx)("div",{children:"Kh\xf4ng t\xecm th\u1ea5y chuy\u1ebfn xe n\xe0o ph\xf9 h\u1ee3p v\u1edbi y\xeau c\u1ea7u t\xecm ki\u1ebfm c\u1ee7a b\u1ea1n."});const D=(e,t,r)=>{f(e),w(t),T(r)};return(0,F.jsxs)("div",{className:"container mx-auto py-8",children:[(0,F.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"K\u1ebft qu\u1ea3 t\xecm ki\u1ebfm chuy\u1ebfn xe"}),(0,F.jsx)("div",{className:"space-y-4",children:m.map((e=>(0,F.jsx)(_,{trip:e,isOpen:e._id===(null===j||void 0===j?void 0:j._id),onToggle:()=>{T((null===j||void 0===j?void 0:j._id)===e._id?null:e)},onContinue:D},e._id)))})]})}},254:(e,t,r)=>{r.d(t,{D:()=>s,v:()=>a});var n=r(4348),i=r.n(n);const s={parseUTCTimeForForm:e=>e?new Date(e):new Date,formatTimeForServer:e=>e?i()(e).utc().format():null,formatDisplayTime:e=>e?i()(e).tz("Asia/Ho_Chi_Minh").format("DD/MM/YYYY HH:mm"):""},a=e=>e?new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e):"0 VND"}}]);
//# sourceMappingURL=717.d2f29680.chunk.js.map