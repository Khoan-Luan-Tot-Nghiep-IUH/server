"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[982],{56982:(e,t,s)=>{s.r(t),s.d(t,{default:()=>m});var n=s(65043),r=s(73216),a=s(60184),l=s(3836),i=(s(48970),s(75995)),c=s(70579);const o=e=>{let{endTime:t,onTimeout:s}=e;const[r,a]=(0,n.useState)(0);(0,n.useEffect)((()=>{const e=new Date(t).getTime(),n=()=>Math.max(0,Math.floor((e-Date.now())/1e3));a(n());const r=setInterval((()=>{a((e=>{const t=n();return t<=0&&(clearInterval(r),s()),t}))}),1e3);return()=>clearInterval(r)}),[t,s]);const l=String(Math.floor(r/60)).padStart(2,"0"),i=String(r%60).padStart(2,"0");return(0,c.jsxs)("div",{className:"w-full text-center font-bold mb-8 p-4 rounded-lg shadow-lg flex flex-col items-center",style:{background:"linear-gradient(135deg, #3a8dff, #1e40af)",color:"white",borderRadius:"8px",boxShadow:"0 6px 12px rgba(0, 0, 0, 0.2)"},children:[(0,c.jsx)("p",{className:"text-lg tracking-wide",style:{marginBottom:"8px"},children:"Th\u1eddi gian thanh to\xe1n c\xf2n l\u1ea1i"}),(0,c.jsxs)("div",{className:"bg-white text-red-600 font-extrabold text-5xl px-6 py-2 rounded-md shadow-md inline-block",style:{boxShadow:"0 4px 15px rgba(0, 0, 0, 0.1)",fontFamily:"monospace"},children:[l,":",i]})]})};var d=s(85627);const h=e=>{let{onSelectVoucher:t}=e;const{data:s,isLoading:n,isError:r}=(0,d.K0)();return(0,c.jsxs)("div",{className:"mb-6",children:[(0,c.jsx)("h3",{className:"text-2xl font-semibold text-gray-800 mb-6",children:"Voucher c\u1ee7a b\u1ea1n"}),n?(0,c.jsx)("p",{children:"\u0110ang t\u1ea3i danh s\xe1ch voucher..."}):r?(0,c.jsx)("p",{className:"text-red-500",children:"Kh\xf4ng th\u1ec3 t\u1ea3i danh s\xe1ch voucher. Vui l\xf2ng th\u1eed l\u1ea1i."}):(0,c.jsx)("ul",{className:"space-y-4",children:null===s||void 0===s?void 0:s.map((e=>(0,c.jsxs)("li",{className:"flex items-center p-4 border border-gray-200 rounded-lg shadow-md bg-white hover:bg-gray-50 cursor-pointer transition duration-200",onClick:()=>t(e),children:[(0,c.jsx)("div",{className:"flex-shrink-0 text-blue-500 mr-4",children:(0,c.jsx)(a.wJQ,{size:24})}),(0,c.jsxs)("div",{className:"flex-1",children:[(0,c.jsxs)("p",{className:"text-lg font-medium text-gray-700 mb-1",children:["M\xe3: ",e.code]}),(0,c.jsxs)("div",{className:"flex items-center text-sm text-gray-500 space-x-4",children:[(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)(a.lWC,{className:"mr-1 text-yellow-500"}),(0,c.jsxs)("span",{children:["Gi\u1ea3m gi\xe1: ",e.discount,"%"]})]}),(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)(a.bfZ,{className:"mr-1 text-red-500"}),(0,c.jsxs)("span",{children:["HSD: ",new Date(e.expiryDate).toLocaleDateString("vi-VN")]})]})]})]})]},e._id)))})]})},m=()=>{const e=(0,r.zy)(),t=(0,r.Zp)(),[s,d]=(0,n.useState)(null),{selectedSeats:m,totalPrice:x,trip:g,bookingId:u,expiryTime:b}=e.state||{},[p,j]=(0,n.useState)(null),[N,{isLoading:y,isError:v,data:f,isSuccess:w}]=(0,l.oN)(),[k,S]=(0,n.useState)(!1),[C,V]=(0,n.useState)(!1),[T,D]=(0,n.useState)({open:!1,message:"",severity:"success"}),O=s?x-x*s.discount/100:x,L=function(e){D({open:!0,message:e,severity:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success"})};return(0,c.jsxs)("div",{className:"container mx-auto p-6 bg-gray-50 min-h-screen",children:[(0,c.jsx)(o,{endTime:b,onTimeout:()=>{L("Th\u1eddi gian thanh to\xe1n \u0111\xe3 h\u1ebft. B\u1ea1n s\u1ebd \u0111\u01b0\u1ee3c chuy\u1ec3n v\u1ec1 trang ch\u1ee7.","error"),setTimeout((()=>{t("/")}),3e3)}}),(0,c.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,c.jsxs)("div",{className:"lg:col-span-2 bg-white p-8 rounded-xl shadow-lg",children:[(0,c.jsx)("h1",{className:"text-2xl font-semibold text-gray-800 mb-6",children:"Ph\u01b0\u01a1ng th\u1ee9c thanh to\xe1n"}),(0,c.jsxs)("div",{className:"mb-6 border rounded-lg p-6 flex items-center cursor-pointer hover:shadow-md "+("Online"===p?"border-blue-500 bg-blue-50":"border-gray-300"),onClick:()=>j("Online"),children:[(0,c.jsx)(a.Acq,{className:"text-3xl text-blue-500 mr-4"}),(0,c.jsxs)("div",{children:[(0,c.jsx)("input",{type:"radio",id:"qr",name:"payment",className:"mr-3 mt-1",checked:"Online"===p,onChange:()=>j("Online")}),(0,c.jsx)("label",{htmlFor:"qr",className:"text-lg font-medium text-gray-700",children:"QR chuy\u1ec3n kho\u1ea3n / V\xed \u0111i\u1ec7n t\u1eed"})]})]}),(0,c.jsxs)("div",{className:"mb-6 border rounded-lg p-6 flex items-center cursor-pointer hover:shadow-md "+("OnBoard"===p?"border-green-500 bg-green-50":"border-gray-300"),onClick:()=>j("OnBoard"),children:[(0,c.jsx)(a.dZW,{className:"text-3xl text-green-500 mr-4"}),(0,c.jsxs)("div",{children:[(0,c.jsx)("input",{type:"radio",id:"onboard",name:"payment",className:"mr-3 mt-1",checked:"OnBoard"===p,onChange:()=>j("OnBoard")}),(0,c.jsx)("label",{htmlFor:"onboard",className:"text-lg font-medium text-gray-700",children:"Thanh to\xe1n khi l\xean xe"})]})]}),v&&(0,c.jsx)("p",{className:"text-red-500 mt-4",children:"\u0110\xe3 c\xf3 l\u1ed7i x\u1ea3y ra. Vui l\xf2ng th\u1eed l\u1ea1i."}),!w&&(0,c.jsxs)("button",{className:"w-full bg-yellow-500 text-white font-semibold py-3 rounded-lg hover:bg-yellow-600 flex items-center justify-center mt-4",onClick:async()=>{if(!p)return void L("Vui l\xf2ng ch\u1ecdn ph\u01b0\u01a1ng th\u1ee9c thanh to\xe1n","error");if(!u)return void L("D\u1eef li\u1ec7u kh\xf4ng h\u1ee3p l\u1ec7","error");const e={bookingId:u,paymentMethod:p,voucherCode:(null===s||void 0===s?void 0:s.code)||null};try{const s=await N(e).unwrap();"Online"===p?(L("\u0110\u1eb7t ch\u1ed7 th\xe0nh c\xf4ng! Vui l\xf2ng nh\u1ea5n v\xe0o li\xean k\u1ebft \u0111\u1ec3 thanh to\xe1n...","success"),setTimeout((()=>{window.open(s.data.paymentLink,"_self")}),2e3)):"OnBoard"===p&&(L("\u0110\u1eb7t ch\u1ed7 th\xe0nh c\xf4ng! Di chuy\u1ec3n \u0111\u1ebfn l\u1ecbch s\u1eed \u0111\u1eb7t v\xe9.","success"),setTimeout((()=>{t("/user/ticket-buy",{state:{orderCode:s.data.orderCode,trip:s.data.trip,seatNumbers:s.data.seatNumbers,totalPrice:s.data.totalPrice,paymentMethod:s.data.paymentMethod}})}),1e3))}catch(n){console.error("L\u1ed7i khi \u0111\u1eb7t ch\u1ed7:",n),L("C\xf3 l\u1ed7i x\u1ea3y ra khi \u0111\u1eb7t ch\u1ed7. Vui l\xf2ng th\u1eed l\u1ea1i.","error")}},disabled:y,children:[(0,c.jsx)(a.tVd,{className:"mr-2"})," ",y?"\u0110ang \u0111\u1eb7t ch\u1ed7...":"\u0110\u1eb7t ch\u1ed7"]})]}),(0,c.jsxs)("div",{className:"bg-white p-8 rounded-xl shadow-lg",children:[(0,c.jsx)("h2",{className:"text-2xl font-semibold text-gray-800 mb-6",children:"Th\xf4ng tin thanh to\xe1n"}),(0,c.jsx)("button",{className:"w-full bg-blue-500 text-white font-semibold py-2 rounded-lg hover:bg-blue-600 transition duration-300 mb-4",onClick:()=>S(!k),children:k?"\u1ea8n voucher":"Ch\u1ecdn voucher"}),k&&(0,c.jsx)("div",{className:"mb-4",children:(0,c.jsx)(h,{onSelectVoucher:e=>{d(e),S(!1)}})}),s&&(0,c.jsxs)("div",{className:"flex justify-between items-center mb-4 p-4 bg-gray-100 border border-gray-300 rounded-lg",children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)("p",{className:"text-sm text-gray-600",children:["M\xe3 voucher: ",(0,c.jsx)("span",{className:"font-semibold",children:s.code})]}),(0,c.jsxs)("p",{className:"text-sm text-gray-600",children:["Gi\u1ea3m gi\xe1: ",(0,c.jsxs)("span",{className:"font-semibold",children:[s.discount,"%"]})]})]}),(0,c.jsx)("button",{className:"text-red-500 text-sm font-medium hover:underline",onClick:()=>{d(null),L("\u0110\xe3 g\u1ee1 b\u1ecf voucher.","info")},children:"G\u1ee1 b\u1ecf"})]}),(0,c.jsxs)("div",{className:"border-t pt-4",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,c.jsx)("p",{className:"text-sm text-gray-500",children:"Gi\xe1 g\u1ed1c:"}),(0,c.jsxs)("p",{className:"text-lg font-semibold "+(s?"text-gray-500 line-through":"text-gray-700"),children:[x.toLocaleString("vi-VN")," VND"]})]}),s&&(0,c.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,c.jsx)("p",{className:"text-sm text-gray-500",children:"Gi\u1ea3m gi\xe1:"}),(0,c.jsxs)("p",{className:"text-lg font-semibold text-green-500",children:["-",(x*s.discount/100).toLocaleString("vi-VN")," VND"]})]}),(0,c.jsxs)("div",{className:"flex justify-between items-center",children:[(0,c.jsx)("p",{className:"text-sm font-semibold text-gray-700",children:"T\u1ed5ng thanh to\xe1n:"}),(0,c.jsxs)("p",{className:"text-xl font-bold text-blue-600",children:[O.toLocaleString("vi-VN")," VND"]})]})]})]})]}),(0,c.jsx)(i.A,{open:T.open,onClose:()=>{D({...T,open:!1})},severity:T.severity,message:T.message})]})}}}]);
//# sourceMappingURL=982.95de35de.chunk.js.map