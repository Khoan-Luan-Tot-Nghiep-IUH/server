"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[843],{27843:(e,t,s)=>{s.r(t),s.d(t,{default:()=>u});var a=s(65043),n=s(3836),l=s(6720),r=s(75995),c=s(73216),i=s(91995),d=s(60184),o=s(70579);const m=e=>{var t,s,a,n,r;let{booking:c,onCancel:i,activeTab:d}=e;const m=(null===(t=c.trip)||void 0===t||null===(s=t.departureLocation)||void 0===s?void 0:s.name)||"N/A",x=(null===(a=c.trip)||void 0===a||null===(n=a.arrivalLocation)||void 0===n?void 0:n.name)||"N/A",u=null!==(r=c.trip)&&void 0!==r&&r.departureTime?new Date(c.trip.departureTime):null;return(0,o.jsxs)("div",{className:"bg-gray-50 shadow-lg rounded-lg p-6 mb-4 transition-transform transform hover:scale-105",children:[(0,o.jsxs)("div",{className:"flex justify-between items-start",children:[(0,o.jsxs)("div",{children:[(0,o.jsxs)("h3",{className:"text-xl font-semibold text-gray-800 flex items-center",children:[(0,o.jsx)(l.gwi,{className:"text-blue-500 mr-2"}),m," \u2192 ",x]}),(0,o.jsxs)("p",{className:"text-sm text-gray-600 flex items-center mt-1",children:[(0,o.jsx)(l.Hvs,{className:"text-blue-500 mr-2"}),u?`${u.toLocaleDateString()} - ${u.toLocaleTimeString()}`:"Th\u1eddi gian kh\xf4ng c\xf3 s\u1eb5n"]})]}),(0,o.jsx)("span",{className:"px-3 py-1 text-xs rounded-full font-semibold "+("Confirmed"===c.status?"bg-green-100 text-green-600":"Completed"===c.status?"bg-blue-100 text-blue-600":"bg-red-100 text-red-600"),children:c.status})]}),(0,o.jsxs)("div",{className:"mt-4 flex justify-between items-center",children:[(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{className:"flex items-center text-gray-700 mb-2",children:[(0,o.jsx)(l.r$9,{className:"text-blue-500 mr-2"}),(0,o.jsx)("span",{className:"font-semibold",children:"Gh\u1ebf:"})," ",c.seatNumbers.join(", ")]}),(0,o.jsxs)("div",{className:"flex items-center text-gray-700 mb-2",children:[(0,o.jsx)("span",{className:"text-blue-500 mr-2",children:"\ud83d\udcb2"}),(0,o.jsx)("span",{className:"font-semibold",children:"Gi\xe1 v\xe9:"})," ",c.totalPrice.toLocaleString()," VND"]}),(0,o.jsxs)("div",{className:"flex items-center text-gray-700",children:[(0,o.jsx)(l.WYw,{className:"text-blue-500 mr-2"}),(0,o.jsx)("span",{className:"font-semibold",children:"M\xe3 \u0111\u1eb7t v\xe9:"})," ",c.orderCode]})]}),"Confirmed"===c.status&&"completed"!==d&&(0,o.jsx)("button",{onClick:()=>i(c._id),className:"bg-red-500 text-white px-4 py-2 rounded-lg",children:"H\u1ee7y v\xe9"})]})]})},x=e=>{let{totalPages:t,currentPage:s,onPageChange:a,onNextPage:n,onPrevPage:l}=e;return(0,o.jsxs)("div",{className:"flex justify-center mt-6 space-x-2",children:[(0,o.jsx)("button",{onClick:l,disabled:1===s,className:"px-3 py-1 rounded-lg "+(1===s?"bg-gray-300 cursor-not-allowed":"bg-blue-500 text-white"),children:"Quay l\u1ea1i"}),[...Array(t).keys()].map((e=>(0,o.jsx)("button",{onClick:()=>a(e+1),className:"px-3 py-1 rounded-lg "+(e+1===s?"bg-blue-500 text-white":"bg-gray-200 text-gray-700"),children:e+1},e+1))),(0,o.jsx)("button",{onClick:n,disabled:s===t,className:"px-3 py-1 rounded-lg "+(s===t?"bg-gray-300 cursor-not-allowed":"bg-blue-500 text-white"),children:"Trang ti\u1ebfp"})]})},u=()=>{const[e,t]=(0,a.useState)([]),[s,u]=(0,a.useState)({current:0,completed:0,canceled:0}),[h,g]=(0,a.useState)("current"),[b,p]=(0,a.useState)(1),{data:j,isLoading:f,isError:v,refetch:N}=(0,n.dH)(),[y]=(0,n.wC)(),C=(0,c.zy)(),[w,k]=(0,a.useState)(!1),[P,S]=(0,a.useState)(null);(0,a.useEffect)((()=>{const e=new URLSearchParams(C.search),t=e.get("success"),s=e.get("message");"true"===t&&s&&$({open:!0,severity:"success",message:s})}),[C]),(0,a.useEffect)((()=>{if(C.state){const{orderCode:e,trip:t,seatNumbers:s,totalPrice:a,paymentMethod:n}=C.state;S({orderCode:e,trip:t,seatNumbers:s,totalPrice:a,paymentMethod:n}),k(!0)}}),[C]);const T=()=>{k(!1)},[L,$]=(0,a.useState)({open:!1,severity:"info",message:""}),D=(e,t)=>{$({open:!0,severity:e,message:t})};(0,a.useEffect)((()=>{if(null!==j&&void 0!==j&&j.success){const e=j.data.reduce(((e,t)=>{var s,a;const n=new Date(t.bookingDate).toLocaleDateString();let l;return"Scheduled"===(null===(s=t.trip)||void 0===s?void 0:s.status)&&"Confirmed"===t.status?l="current":"Completed"===(null===(a=t.trip)||void 0===a?void 0:a.status)&&"Confirmed"===t.status?l="completed":"Cancelled"===t.status&&(l="canceled"),l&&(e[l]||(e[l]={}),e[l][n]||(e[l][n]=[]),e[l][n].push(t)),e}),{});t(e),u({current:e.current?Object.values(e.current).flat().length:0,completed:e.completed?Object.values(e.completed).flat().length:0,canceled:e.canceled?Object.values(e.canceled).flat().length:0})}}),[j]);const M=e=>{p(e)},O=()=>{p((e=>e+1))},H=()=>{p((e=>Math.max(e-1,1)))},A=async e=>{try{await y(e).unwrap(),D("success","H\u1ee7y v\xe9 th\xe0nh c\xf4ng!"),N()}catch(t){D("error",`L\u1ed7i khi h\u1ee7y v\xe9: ${t.message}`)}};if(f)return(0,o.jsx)("p",{children:"Loading..."});if(v||null===j||void 0===j||!j.success)return(0,o.jsx)("div",{className:"container mx-auto mt-10 bg-white shadow-md rounded-lg p-8",children:(0,o.jsxs)("p",{children:["B\u1ea1n ch\u01b0a c\xf3 l\u1ecbch s\u1eed \u0111\u1eb7t v\xe9 n\xe0o. ",(0,o.jsx)("a",{href:"/",className:"text-blue-600",children:"\u0110\u1eb7t v\xe9 ngay!"})]})});return(0,o.jsxs)("div",{className:"container mx-auto mt-10 bg-white shadow-md rounded-lg p-8",children:[(0,o.jsx)("div",{className:"border-b border-gray-300 mb-6",children:(0,o.jsx)("nav",{className:"flex justify-center space-x-8",children:["current","completed","canceled"].map((e=>(0,o.jsx)("button",{onClick:()=>{g(e),p(1)},className:"py-3 px-4 text-lg font-semibold "+(h===e?"text-blue-600 border-b-2 border-blue-500":"text-gray-600"),children:"current"===e?`Hi\u1ec7n t\u1ea1i (${s.current})`:"completed"===e?`\u0110\xe3 \u0111i (${s.completed})`:`\u0110\xe3 h\u1ee7y (${s.canceled})`},e)))})}),(0,o.jsx)("div",{children:(t=>{const s=e[t];if(!s||0===Object.keys(s).length)return(0,o.jsxs)("p",{className:"text-gray-600",children:["current"===t?"B\u1ea1n ch\u01b0a c\xf3 chuy\u1ebfn s\u1eafp \u0111i n\xe0o. ":"completed"===t?"B\u1ea1n ch\u01b0a c\xf3 chuy\u1ebfn n\xe0o \u0111\xe3 ho\xe0n th\xe0nh.":"B\u1ea1n ch\u01b0a c\xf3 v\xe9 n\xe0o \u0111\xe3 h\u1ee7y.","current"===t&&(0,o.jsx)("a",{href:"/book",className:"text-blue-600",children:"\u0110\u1eb7t chuy\u1ebfn \u0111i ngay!"})]});const a=Object.entries(s),n=Math.ceil(a.length/5),l=a.slice(5*(b-1),5*b);return(0,o.jsxs)(o.Fragment,{children:[l.map((e=>{let[t,s]=e;return(0,o.jsxs)("div",{className:"mb-8",children:[(0,o.jsx)("h3",{className:"text-lg font-semibold text-gray-700 mb-4",children:t}),s.map((e=>(0,o.jsx)(m,{booking:e,activeTab:h,onCancel:A},e._id)))]},t)})),(0,o.jsx)(x,{totalPages:n,currentPage:b,onPageChange:M,onNextPage:O,onPrevPage:H})]})})(h)}),(0,o.jsx)(i.A,{title:"Th\xf4ng Tin \u0110\u01a1n H\xe0ng",visible:w,onOk:T,onCancel:T,okText:"X\xe1c nh\u1eadn",cancelText:"\u0110\xf3ng",children:P&&(0,o.jsxs)("div",{className:"space-y-8 text-gray-700",children:[(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("p",{className:"font-medium text-gray-500 mr-2",children:"M\xe3 \u0111\u01a1n h\xe0ng:"}),(0,o.jsx)("p",{className:"text-lg font-semibold",children:P.orderCode})]}),(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)(l.r$9,{className:"text-blue-500 mr-2"}),(0,o.jsx)("p",{className:"font-medium text-gray-500 mr-2",children:"Gh\u1ebf:"}),(0,o.jsx)("p",{className:"text-lg font-semibold",children:P.seatNumbers.join(", ")})]}),(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)(d.GeR,{className:"text-green-500 mr-2"}),(0,o.jsx)("p",{className:"font-medium text-gray-500 mr-2",children:"T\u1ed5ng ti\u1ec1n:"}),(0,o.jsxs)("p",{className:"text-lg font-bold text-green-600",children:[P.totalPrice.toLocaleString()," VND"]})]}),(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)(d.bfZ,{className:"text-gray-500 mr-2"}),(0,o.jsx)("p",{className:"font-medium text-gray-500 mr-2",children:"Ph\u01b0\u01a1ng th\u1ee9c thanh to\xe1n:"}),(0,o.jsx)("p",{className:"text-lg font-semibold",children:"OnBoard"===P.paymentMethod?"Thanh to\xe1n khi l\xean xe":"Thanh to\xe1n online"})]})]})}),(0,o.jsx)(r.A,{open:L.open,onClose:()=>{$((e=>({...e,open:!1})))},severity:L.severity,message:L.message})]})}}}]);
//# sourceMappingURL=843.907d3361.chunk.js.map