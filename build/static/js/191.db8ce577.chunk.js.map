{"version":3,"file":"static/js/191.db8ce577.chunk.js","mappings":"+OAQA,MA2IA,EA3ImBA,KACjB,MAAMC,GAAWC,EAAAA,EAAAA,KAAaC,GAAUA,EAAMC,KAAKH,WAC7CI,GAAWC,EAAAA,EAAAA,OACTC,KAAMC,EAAQ,MAAEC,EAAK,UAAEC,EAAS,QAAEC,IAAYC,EAAAA,EAAAA,SAAuBC,EAAW,CACtFC,MAAOb,KAEFc,GAA0BL,UAAWM,KAAiBC,EAAAA,EAAAA,OACtDC,EAAQC,IAAaC,EAAAA,EAAAA,UAAS,KAC9BC,EAAcC,IAAmBF,EAAAA,EAAAA,WAAUnB,GAiB5CsB,EAAgBA,KACpBD,GAAgB,GAChBjB,EAAS,SAAS,EAGdmB,EAAoBA,KACxBF,GAAgB,GAChBjB,EAAS,IAAI,EAGToB,EAAmBA,KACvBpB,EAAS,IAAI,EAGf,OAAKJ,GAgBHyB,EAAAA,EAAAA,MAAA,OAAKC,UAAU,wBAAuBC,SAAA,EACpCC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,oDAAmDC,SAAC,mCAGlEF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,kHAAiHC,SAAA,EAC9HC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,UAASC,SAAC,oBACxBC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,oCAAmCC,UAAU,OAAR3B,QAAQ,IAARA,OAAQ,EAARA,EAAU6B,gBAAiB,KAC9ED,EAAAA,EAAAA,KAAA,KAAAD,SAAG,wCAILF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,yCAAwCC,SAAA,EACrDF,EAAAA,EAAAA,MAAA,MAAIC,UAAU,6DAA4DC,SAAA,EACxEC,EAAAA,EAAAA,KAACE,EAAAA,IAAU,CAACJ,UAAU,yBAAyB,qDAEjDD,EAAAA,EAAAA,MAAA,OAAKC,UAAU,0BAAyBC,SAAA,EACtCC,EAAAA,EAAAA,KAAA,SACEG,KAAK,SACLC,MAAOf,EACPgB,SAAWC,GAAMhB,EAAUgB,EAAEC,OAAOH,MAAMI,QAC1CC,YAAY,2BACZX,UAAU,sGAEZE,EAAAA,EAAAA,KAAA,UACEU,QArEWC,UACnB,IAAKtB,GAAUA,GAAU,GAAKuB,MAAMvB,GAClCwB,EAAAA,GAAQjC,MAAM,kGAGhB,IACE,MAAMkC,QAAiB5B,EAAuB,CAAEG,OAAQ0B,SAAS1B,KAAW2B,SAC5EH,EAAAA,GAAQI,QAAQ,sHAAsDH,EAASI,QAAQC,aACvF7B,EAAU,IACVR,GACF,CAAE,MAAOF,GAAQ,IAADwC,EACdP,EAAAA,GAAQjC,OAAW,OAALA,QAAK,IAALA,GAAW,QAANwC,EAALxC,EAAOF,YAAI,IAAA0C,OAAN,EAALA,EAAaP,UAAW,8DACxC,GA0DQQ,SAAUlC,EACVW,UAAW,oEACTX,EAAc,gCAAkC,qBAC/CY,SAEFZ,EAAc,6BAAgB,sBAGnCa,EAAAA,EAAAA,KAAA,KAAGF,UAAU,6BAA4BC,SAAC,mDAI5CF,EAAAA,EAAAA,MAAA,OAAAE,SAAA,EACEC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,2CAA0CC,SAAC,8BAExDlB,GACCmB,EAAAA,EAAAA,KAAA,OAAKF,UAAU,sBAAqBC,UAClCC,EAAAA,EAAAA,KAACsB,EAAAA,EAAI,CAACC,KAAK,YAEX3C,GACFoB,EAAAA,EAAAA,KAAA,KAAGF,UAAU,2BAA0BC,SAAC,+CACtCpB,GAAYA,EAAS6C,OAAS,GAChCxB,EAAAA,EAAAA,KAAA,OAAKF,UAAU,uDAAsDC,SAClEpB,EAAS8C,KAAKP,IACbrB,EAAAA,EAAAA,MAAA,OAEEC,UAAW,6CACToB,EAAQQ,OAAS,8BAAgC,4BAChD3B,SAAA,EAEHC,EAAAA,EAAAA,KAAC2B,EAAAA,GAAM,CAAC7B,UAAU,qDAClBD,EAAAA,EAAAA,MAAA,MAAIC,UAAU,uCAAsCC,SAAA,CAAC,UAAKmB,EAAQU,SAClE/B,EAAAA,EAAAA,MAAA,KAAGC,UAAU,wBAAuBC,SAAA,CAAC,qBAAWmB,EAAQC,SAAS,QACjEtB,EAAAA,EAAAA,MAAA,KAAGC,UAAU,wBAAuBC,SAAA,CAAC,4BAAWmB,EAAQW,aACxDhC,EAAAA,EAAAA,MAAA,KAAGC,UAAU,6BAA4BC,SAAA,CAAC,aAClC,IAAI+B,KAAKZ,EAAQa,YAAYC,yBAErChC,EAAAA,EAAAA,KAAA,UACEU,QAASd,EACTE,UAAW,kDACToB,EAAQQ,OACJ,4CACA,4CAENL,SAAUH,EAAQQ,OAAO3B,SAExBmB,EAAQQ,OAAS,+BAAe,6BArB9BR,EAAQe,UA2BnBjC,EAAAA,EAAAA,KAAA,KAAGF,UAAU,4BAA2BC,SAAC,0CA3F7CC,EAAAA,EAAAA,KAACkC,EAAAA,EAAK,CACJC,MAAM,qCACNC,QAAS5C,EACT6C,KAAM3C,EACN4C,SAAU3C,EACV4C,OAAO,2BACPC,WAAW,+BAAoBzC,UAE/BC,EAAAA,EAAAA,KAAA,KAAAD,SAAG,mLAsFD,C","sources":["components/auth/sidebar/OffersPage.js"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { useSelector } from 'react-redux';\r\nimport { useGetAllVouchersQuery, useRedeemPointsForVoucherMutation } from '../../../Redux/User/apiSlice';\r\nimport { FaGift } from 'react-icons/fa';\r\nimport { GiTwoCoins } from 'react-icons/gi';\r\nimport { Modal, Spin, message } from 'antd';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nconst OffersPage = () => {\r\n  const userInfo = useSelector((state) => state.user.userInfo);\r\n  const navigate = useNavigate();\r\n  const { data: vouchers, error, isLoading, refetch } = useGetAllVouchersQuery(undefined, {\r\n    skip: !userInfo,\r\n  });\r\n  const [redeemPointsForVoucher, { isLoading: isRedeeming }] = useRedeemPointsForVoucherMutation();\r\n  const [points, setPoints] = useState('');\r\n  const [modalVisible, setModalVisible] = useState(!userInfo);\r\n\r\n  const handleRedeem = async () => {\r\n    if (!points || points <= 0 || isNaN(points)) {\r\n      message.error('Vui lòng nhập số điểm hợp lệ để đổi.');\r\n      return;\r\n    }\r\n    try {\r\n      const response = await redeemPointsForVoucher({ points: parseInt(points) }).unwrap();\r\n      message.success(`Đổi điểm thành công! Bạn đã nhận được voucher giảm ${response.voucher.discount}%`);\r\n      setPoints('');\r\n      refetch();\r\n    } catch (error) {\r\n      message.error(error?.data?.message || 'Lỗi khi đổi điểm lấy voucher.');\r\n    }\r\n  };\r\n\r\n  const handleModalOk = () => {\r\n    setModalVisible(false);\r\n    navigate('/login');\r\n  };\r\n\r\n  const handleModalCancel = () => {\r\n    setModalVisible(false);\r\n    navigate('/');\r\n  };\r\n\r\n  const handleUseVoucher = () => {\r\n    navigate('/'); // Điều hướng về trang \"/\"\r\n  };\r\n\r\n  if (!userInfo) {\r\n    return (\r\n      <Modal\r\n        title=\"Chưa đăng nhập\"\r\n        visible={modalVisible}\r\n        onOk={handleModalOk}\r\n        onCancel={handleModalCancel}\r\n        okText=\"Đăng nhập\"\r\n        cancelText=\"Quay lại trang chủ\"\r\n      >\r\n        <p>Bạn cần đăng nhập để sử dụng các ưu đãi. Hãy đăng nhập hoặc quay lại trang chủ.</p>\r\n      </Modal>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"max-w-4xl mx-auto p-4\">\r\n      <h2 className=\"text-3xl font-bold text-center text-gray-800 mb-6\">Ưu Đãi & Voucher</h2>\r\n\r\n      {/* Hiển thị điểm thưởng */}\r\n      <div className=\"bg-gradient-to-r from-blue-500 to-purple-500 text-white text-center font-semibold rounded-lg p-6 mb-8 shadow-lg\">\r\n        <h3 className=\"text-lg\">Bạn có</h3>\r\n        <h1 className=\"text-4xl font-extrabold underline\">{userInfo?.loyaltyPoints || 0}</h1>\r\n        <p>điểm thưởng</p>\r\n      </div>\r\n\r\n      {/* Form đổi điểm lấy voucher */}\r\n      <div className=\"bg-white rounded-lg shadow-md p-6 mb-8\">\r\n        <h3 className=\"text-lg font-semibold text-gray-800 mb-4 flex items-center\">\r\n          <GiTwoCoins className=\"text-yellow-500 mr-2\" /> Đổi Điểm Lấy Voucher\r\n        </h3>\r\n        <div className=\"flex items-center gap-4\">\r\n          <input\r\n            type=\"number\"\r\n            value={points}\r\n            onChange={(e) => setPoints(e.target.value.trim())}\r\n            placeholder=\"Nhập điểm\"\r\n            className=\"flex-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n          />\r\n          <button\r\n            onClick={handleRedeem}\r\n            disabled={isRedeeming}\r\n            className={`bg-blue-600 text-white px-6 py-3 rounded-lg font-bold shadow-md ${\r\n              isRedeeming ? 'opacity-50 cursor-not-allowed' : 'hover:bg-blue-700'\r\n            }`}\r\n          >\r\n            {isRedeeming ? 'Đang đổi...' : 'Đổi'}\r\n          </button>\r\n        </div>\r\n        <p className=\"text-gray-500 text-sm mt-2\">100 điểm = voucher giảm 10%</p>\r\n      </div>\r\n\r\n      {/* Danh sách voucher */}\r\n      <div>\r\n        <h3 className=\"text-xl font-semibold text-gray-800 mb-4\">Voucher Của Bạn</h3>\r\n\r\n        {isLoading ? (\r\n          <div className=\"flex justify-center\">\r\n            <Spin size=\"large\" />\r\n          </div>\r\n        ) : error ? (\r\n          <p className=\"text-center text-red-500\">Lỗi khi tải danh sách voucher</p>\r\n        ) : vouchers && vouchers.length > 0 ? (\r\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n            {vouchers.map((voucher) => (\r\n              <div\r\n                key={voucher._id}\r\n                className={`relative p-4 rounded-lg shadow-md border ${\r\n                  voucher.isUsed ? 'bg-gray-100 border-gray-400' : 'bg-white border-blue-300'\r\n                }`}\r\n              >\r\n                <FaGift className=\"absolute top-4 right-4 text-2xl text-yellow-400\" />\r\n                <h4 className=\"text-lg font-bold text-gray-800 mb-2\">Mã: {voucher.code}</h4>\r\n                <p className=\"text-sm text-gray-600\">Giảm giá: {voucher.discount}%</p>\r\n                <p className=\"text-sm text-gray-600\">Số lượng: {voucher.quantity}</p>\r\n                <p className=\"text-sm text-gray-600 mb-4\">\r\n                  Hạn: {new Date(voucher.expiryDate).toLocaleDateString()}\r\n                </p>\r\n                <button\r\n                  onClick={handleUseVoucher} \r\n                  className={`w-full text-center py-2 rounded font-semibold ${\r\n                    voucher.isUsed\r\n                      ? 'bg-gray-400 text-white cursor-not-allowed'\r\n                      : 'bg-blue-600 text-white hover:bg-blue-700'\r\n                  }`}\r\n                  disabled={voucher.isUsed}\r\n                >\r\n                  {voucher.isUsed ? 'Đã sử dụng' : 'Sử dụng ngay'}\r\n                </button>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        ) : (\r\n          <p className=\"text-center text-gray-500\">Không có voucher nào.</p>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default OffersPage;\r\n"],"names":["OffersPage","userInfo","useSelector","state","user","navigate","useNavigate","data","vouchers","error","isLoading","refetch","useGetAllVouchersQuery","undefined","skip","redeemPointsForVoucher","isRedeeming","useRedeemPointsForVoucherMutation","points","setPoints","useState","modalVisible","setModalVisible","handleModalOk","handleModalCancel","handleUseVoucher","_jsxs","className","children","_jsx","loyaltyPoints","GiTwoCoins","type","value","onChange","e","target","trim","placeholder","onClick","async","isNaN","message","response","parseInt","unwrap","success","voucher","discount","_error$data","disabled","Spin","size","length","map","isUsed","FaGift","code","quantity","Date","expiryDate","toLocaleDateString","_id","Modal","title","visible","onOk","onCancel","okText","cancelText"],"sourceRoot":""}