"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[981],{53981:(e,t,s)=>{s.r(t),s.d(t,{default:()=>j});var i=s(65043),a=s(73216),l=s(3836),n=s(83003),r=s(36210),c=s(70579);const d=e=>{let{selectedSeats:t,totalPrice:s,trip:a,onSubmit:l}=e;const d=(0,n.d4)((e=>e.user.userInfo)),[m,o]=(0,i.useState)({name:"",phone:"",email:"",countryCode:"+84"}),[x,h]=(0,i.useState)({});(0,i.useEffect)((()=>{d&&o({name:d.fullName||"",phone:d.phoneNumber||"",email:d.email||"",countryCode:"+84"})}),[d]);return(0,c.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg",children:[(0,c.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Th\xf4ng tin li\xean h\u1ec7"}),(0,c.jsxs)("form",{onSubmit:e=>{e.preventDefault();const t=(()=>{const e={};return m.name.trim()||(e.name="T\xean kh\xf4ng \u0111\u01b0\u1ee3c \u0111\u1ec3 tr\u1ed1ng"),/^[0-9]{9,10}$/.test(m.phone)||(e.phone="S\u1ed1 \u0111i\u1ec7n tho\u1ea1i kh\xf4ng h\u1ee3p l\u1ec7"),/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(m.email)||(e.email="Email kh\xf4ng h\u1ee3p l\u1ec7"),e})();Object.keys(t).length>0?h(t):(h({}),l&&l(m))},className:"space-y-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)("label",{className:"block text-sm mb-2",children:["T\xean ng\u01b0\u1eddi \u0111i ",(0,c.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,c.jsx)("input",{type:"text",value:m.name,onChange:e=>o({...m,name:e.target.value}),className:"w-full px-3 py-2.5 border rounded-lg "+(x.name?"border-red-500":"border-gray-200")}),x.name&&(0,c.jsx)("p",{className:"text-red-500 text-sm mt-1",children:x.name})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("label",{className:"block text-sm mb-2",children:["S\u1ed1 \u0111i\u1ec7n tho\u1ea1i ",(0,c.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,c.jsxs)("div",{className:"flex gap-2",children:[(0,c.jsxs)("button",{type:"button",className:"w-[110px] px-3 py-2.5 border border-gray-200 rounded-lg bg-white flex items-center justify-between",children:[(0,c.jsx)("span",{children:"VN +84"}),(0,c.jsx)("span",{className:"text-gray-400",children:"\u25bc"})]}),(0,c.jsx)("input",{type:"tel",value:m.phone,onChange:e=>o({...m,phone:e.target.value}),className:"flex-1 px-3 py-2.5 border rounded-lg "+(x.phone?"border-red-500":"border-gray-200")})]}),x.phone&&(0,c.jsx)("p",{className:"text-red-500 text-sm mt-1",children:x.phone})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("label",{className:"block text-sm mb-2",children:["Email \u0111\u1ec3 nh\u1eadn th\xf4ng tin \u0111\u1eb7t ch\u1ed7 ",(0,c.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,c.jsx)("input",{type:"email",value:m.email,onChange:e=>o({...m,email:e.target.value}),className:"w-full px-3 py-2.5 border rounded-lg "+(x.email?"border-red-500":"border-gray-200")}),x.email&&(0,c.jsx)("p",{className:"text-red-500 text-sm mt-1",children:x.email})]}),(0,c.jsxs)("div",{className:"p-4 bg-green-50 border border-green-100 rounded-lg text-sm text-gray-600 flex items-start gap-2",children:[(0,c.jsx)(r.A,{className:"w-5 h-5 text-green-500 mt-0.5"}),(0,c.jsx)("span",{children:"S\u1ed1 \u0111i\u1ec7n tho\u1ea1i v\xe0 email \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 g\u1eedi th\xf4ng tin \u0111\u01a1n h\xe0ng v\xe0 li\xean h\u1ec7 khi c\u1ea7n thi\u1ebft."})]})]})]})};var m=s(50423);const o=e=>{let{totalPrice:t,selectedSeats:s}=e;const[a,l]=(0,i.useState)(!1);return(0,c.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center",children:[(0,c.jsx)("h3",{className:"text-xl font-semibold mb-2",children:"T\u1ea1m t\xednh"}),(0,c.jsx)("button",{onClick:()=>{l(!a)},className:"text-xl",children:a?(0,c.jsx)(m.Ik,{}):(0,c.jsx)(m.pte,{})})]}),(0,c.jsxs)("p",{className:"text-2xl font-bold text-blue-600",children:[null===t||void 0===t?void 0:t.toLocaleString("vi-VN"),"\u0111"]}),a&&(0,c.jsxs)("div",{className:"mt-2",children:[(0,c.jsxs)("p",{className:"text-sm text-gray-500",children:["Gi\xe1 v\xe9: ",null===t||void 0===t?void 0:t.toLocaleString("vi-VN")," x ",s.length," gh\u1ebf"]}),(0,c.jsxs)("p",{className:"mt-1 text-sm text-gray-500",children:["M\xe3 gh\u1ebf/gi\u01b0\u1eddng: ",s.join(", ")]})]})]})};var x=s(60184);const h=e=>{var t,s,a,l,n,r,d,m,o,h,g,u;let{trip:p}=e;const[j,b]=(0,i.useState)(!1),v=()=>{b(!j)};return(0,c.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md max-w-lg mx-auto",children:[(0,c.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"Th\xf4ng tin chuy\u1ebfn \u0111i"}),p?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,c.jsx)(x.PnS,{className:"text-blue-500"}),(0,c.jsx)("p",{className:"text-sm text-gray-500",children:p.departureTime?new Date(p.departureTime).toLocaleDateString("vi-VN",{weekday:"short",day:"2-digit",month:"2-digit",year:"numeric"}):"Ch\u01b0a c\xf3 ng\xe0y \u0111i"})]}),(0,c.jsx)("button",{onClick:v,className:"text-blue-500 text-sm",children:"Chi ti\u1ebft"})]}),(0,c.jsx)("div",{className:"mb-4",children:(0,c.jsx)("div",{className:"flex justify-between items-center",children:(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"font-medium",children:(null===(t=p.busType)||void 0===t?void 0:t.name)||"Ch\u01b0a c\xf3 th\xf4ng tin xe"}),(0,c.jsx)("p",{className:"text-sm text-gray-500",children:(null===(s=p.busType)||void 0===s?void 0:s.description)||"Ch\u01b0a c\xf3 m\xf4 t\u1ea3"})]})})}),(0,c.jsx)("div",{className:"border-t border-gray-200 my-4"}),(0,c.jsx)("div",{className:"mb-4",children:(0,c.jsxs)("div",{className:"flex justify-between",children:[(0,c.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,c.jsx)(x.w_X,{className:"text-blue-500 mt-1"}),(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"text-lg font-semibold",children:p.departureTime?new Date(p.departureTime).toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"}):"Ch\u01b0a c\xf3 gi\u1edd \u0111i"}),(0,c.jsx)("p",{className:"text-sm text-gray-500",children:(null===(a=p.departureLocation)||void 0===a?void 0:a.name)||"Ch\u01b0a c\xf3 \u0111i\u1ec3m \u0111i"}),(0,c.jsx)("p",{className:"text-sm text-gray-500",children:(null===(l=p.departureLocation)||void 0===l?void 0:l.address)||"Ch\u01b0a c\xf3 \u0111\u1ecba ch\u1ec9"})]})]}),(0,c.jsx)("button",{className:"text-blue-500 text-sm",children:"Thay \u0111\u1ed5i"})]})}),(0,c.jsx)("div",{className:"mb-4",children:(0,c.jsxs)("div",{className:"flex justify-between",children:[(0,c.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,c.jsx)(x.vq8,{className:"text-red-500 mt-1"}),(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"text-lg font-semibold",children:p.arrivalTime?new Date(p.arrivalTime).toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"}):"Ch\u01b0a c\xf3 gi\u1edd \u0111\u1ebfn"}),(0,c.jsx)("p",{className:"text-sm text-gray-500",children:(null===(n=p.arrivalLocation)||void 0===n?void 0:n.name)||"Ch\u01b0a c\xf3 \u0111i\u1ec3m \u0111\u1ebfn"}),(0,c.jsx)("p",{className:"text-sm text-gray-500",children:(null===(r=p.arrivalLocation)||void 0===r?void 0:r.address)||"Ch\u01b0a c\xf3 \u0111\u1ecba ch\u1ec9"})]})]}),(0,c.jsx)("button",{className:"text-blue-500 text-sm",children:"Thay \u0111\u1ed5i"})]})}),(0,c.jsxs)("div",{className:`fixed inset-y-0 right-0 transform ${j?"translate-x-0":"translate-x-full"} transition-transform duration-300 w-full max-w-md bg-white shadow-lg z-50`,children:[(0,c.jsx)("div",{className:"bg-blue-600 p-4 text-white",children:(0,c.jsxs)("div",{className:"flex justify-between items-center",children:[(0,c.jsx)("h2",{className:"text-lg font-semibold",children:(null===(d=p.busType)||void 0===d?void 0:d.name)||"Vie Limousine"}),(0,c.jsx)("p",{className:"text-sm",children:p.departureTime&&`${new Date(p.departureTime).toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"})} \u2022 ${new Date(p.departureTime).toLocaleDateString("vi-VN",{weekday:"short",day:"2-digit",month:"2-digit",year:"numeric"})}`})]})}),(0,c.jsxs)("div",{className:"p-6",children:[(0,c.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"Chi ti\u1ebft chuy\u1ebfn \u0111i"}),(0,c.jsxs)("div",{className:"mb-4",children:[(0,c.jsxs)("p",{className:"text-sm text-gray-500",children:["Lo\u1ea1i xe: ",(null===(m=p.busType)||void 0===m?void 0:m.name)||"Ch\u01b0a c\xf3 th\xf4ng tin xe"]}),(0,c.jsxs)("p",{className:"text-sm text-gray-500",children:["S\u1ed1 gh\u1ebf/gi\u01b0\u1eddng: ",p.seat||"Ch\u01b0a c\xf3 th\xf4ng tin gh\u1ebf"]}),(0,c.jsxs)("p",{className:"text-sm text-gray-500",children:["Gi\xe1 v\xe9: ",p.price?`${p.price.toLocaleString()}\u0111`:"Ch\u01b0a c\xf3 gi\xe1 v\xe9"]})]}),(0,c.jsxs)("div",{className:"mb-4",children:[(0,c.jsx)("h4",{className:"font-semibold text-lg",children:"\u0110i\u1ec3m \u0111\xf3n"}),(0,c.jsx)("p",{children:(null===(o=p.departureLocation)||void 0===o?void 0:o.name)||"Ch\u01b0a c\xf3 \u0111i\u1ec3m \u0111\xf3n"}),(0,c.jsx)("p",{className:"text-sm text-gray-500",children:(null===(h=p.departureLocation)||void 0===h?void 0:h.address)||"Ch\u01b0a c\xf3 \u0111\u1ecba ch\u1ec9"}),(0,c.jsxs)("p",{className:"text-sm text-gray-500",children:["D\u1ef1 ki\u1ebfn \u0111\xf3n l\xfac:"," ",p.departureTime?new Date(p.departureTime).toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"}):"Ch\u01b0a c\xf3 gi\u1edd \u0111\xf3n"]})]}),(0,c.jsxs)("div",{className:"mb-4",children:[(0,c.jsx)("h4",{className:"font-semibold text-lg",children:"\u0110i\u1ec3m tr\u1ea3"}),(0,c.jsx)("p",{children:(null===(g=p.arrivalLocation)||void 0===g?void 0:g.name)||"Ch\u01b0a c\xf3 \u0111i\u1ec3m tr\u1ea3"}),(0,c.jsx)("p",{className:"text-sm text-gray-500",children:(null===(u=p.arrivalLocation)||void 0===u?void 0:u.address)||"Ch\u01b0a c\xf3 \u0111\u1ecba ch\u1ec9"}),(0,c.jsxs)("p",{className:"text-sm text-gray-500",children:["D\u1ef1 ki\u1ebfn tr\u1ea3 l\xfac:"," ",p.arrivalTime?new Date(p.arrivalTime).toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"}):"Ch\u01b0a c\xf3 gi\u1edd tr\u1ea3"]})]}),(0,c.jsx)("button",{onClick:v,className:"mt-4 w-full bg-blue-500 text-white font-medium py-2 px-4 rounded-lg hover:bg-blue-600 transition duration-200",children:"\u0110\xf3ng"})]})]}),j&&(0,c.jsx)("div",{onClick:v,className:"fixed inset-0 bg-black opacity-50 z-40"})]}):(0,c.jsx)("p",{children:"Ch\u01b0a c\xf3 th\xf4ng tin chuy\u1ebfn \u0111i."})]})};var g=s(14723),u=s(91995),p=s(81016);const j=()=>{const e=(0,a.zy)(),t=(0,a.Zp)(),s=(0,p.Y)(),{selectedSeats:n,totalPrice:r,trip:x}=e.state||{},[j,{isLoading:b}]=(0,l.R2)(),[v,N]=(0,i.useState)(!1);s?(console.log("Socket is available in BookingPage:",s),s.on("connect",(()=>{console.log("Socket reconnected in BookingPage:",s.id)}))):console.error("Socket is not available in BookingPage.");return(0,c.jsxs)("div",{className:"min-h-screen pb-0",children:[(0,c.jsx)(g.A,{}),(0,c.jsxs)("div",{className:"container mx-auto px-4 py-6 grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,c.jsx)("div",{className:"lg:col-span-3 mb-4",children:(0,c.jsxs)("button",{onClick:()=>{N(!0)},className:"text-blue-500 flex items-center mb-4",children:[(0,c.jsx)(m.m6W,{}),"Quay l\u1ea1i"]})}),(0,c.jsxs)("div",{className:"lg:col-span-2",children:[(0,c.jsx)(d,{selectedSeats:n,totalPrice:r,trip:x}),(0,c.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-md mt-6",children:(0,c.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"Ti\u1ec7n \xedch"})})]}),(0,c.jsxs)("div",{className:"lg:col-span-1",children:[(0,c.jsx)(o,{totalPrice:r,selectedSeats:n}),(0,c.jsx)("div",{className:"my-6"}),(0,c.jsx)(h,{trip:x})]})]}),(0,c.jsx)(u.A,{title:"X\xe1c nh\u1eadn gi\u1ea3i ph\xf3ng gh\u1ebf",visible:v,onOk:()=>{n&&x&&s&&n.forEach((e=>{console.log(`Attempting to release seat ${e} for trip ${x._id}`),s.emit("releaseSeat",{tripId:x._id,seatNumber:e}),console.log(`Released seat ${e} for trip ${x._id} successfully`)})),N(!1),t(-1)},onCancel:()=>{N(!1)},okText:"\u0110\u1ed3ng \xfd",cancelText:"H\u1ee7y",children:(0,c.jsx)("p",{children:"B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n gi\u1ea3i ph\xf3ng c\xe1c gh\u1ebf \u0111\xe3 ch\u1ecdn kh\xf4ng?"})}),(0,c.jsx)("div",{className:"w-full h-full bg-white shadow-md mt-6",children:(0,c.jsxs)("div",{className:"container mx-auto",children:[(0,c.jsxs)("div",{className:"px-4 py-6 flex justify-between items-center space-x-4",children:[(0,c.jsx)("button",{onClick:async()=>{if(n&&r&&x)try{const e=await j({tripId:x._id,seatNumbers:n}).unwrap();t("/payment-methods",{state:{selectedSeats:n,totalPrice:e.data.totalPrice,trip:x,bookingId:e.data.bookingId,expiryTime:e.data.expiryTime}})}catch(e){console.error("L\u1ed7i khi t\u1ea1o booking draft:",e)}else console.error("D\u1eef li\u1ec7u kh\xf4ng \u0111\u1ea7y \u0111\u1ee7!")},className:"bg-blue-800 text-white font-semibold px-6 py-3 rounded-lg hover:bg-blue-900 transition duration-200 w-1/2 "+(b?"opacity-50 cursor-not-allowed":""),disabled:b,children:b?"\u0110ang x\u1eed l\xfd...":"Ti\u1ebfp t\u1ee5c \u0111\u1eb7t v\xe9 m\u1ed9t chi\u1ec1u"}),(0,c.jsx)("button",{className:"bg-yellow-500 text-white font-semibold px-6 py-3 rounded-lg hover:bg-yellow-600 transition duration-200 w-1/2",children:"\u0110\u1eb7t th\xeam chi\u1ec1u v\u1ec1"})]}),(0,c.jsxs)("div",{className:"px-4 pb-6 flex justify-between items-center",children:[(0,c.jsxs)("p",{className:"text-sm text-gray-600",children:["B\u1eb1ng vi\u1ec7c ti\u1ebfp t\u1ee5c, b\u1ea1n \u0111\u1ed3ng \xfd v\u1edbi"," ",(0,c.jsx)("a",{href:"#",className:"text-blue-500 underline",children:"Ch\xednh s\xe1ch b\u1ea3o m\u1eadt thanh to\xe1n"}),"v\xe0",(0,c.jsx)("a",{href:"#",className:"text-blue-500 underline",children:"Quy ch\u1ebf"})]}),(0,c.jsxs)("div",{className:"text-green-600 text-sm font-semibold",children:["\u0110\u1eb7t th\xeam chi\u1ec1u v\u1ec1, gi\u1ea3m ngay 20k!",(0,c.jsx)("a",{href:"#",className:"text-blue-500 underline",children:"Chi ti\u1ebft"})]})]})]})})]})}}}]);
//# sourceMappingURL=981.73835179.chunk.js.map