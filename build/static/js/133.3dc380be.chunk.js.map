{"version":3,"file":"static/js/133.3dc380be.chunk.js","mappings":"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","sources":["../node_modules/jwt-decode/build/esm/index.js","components/auth/Login.js"],"sourcesContent":["export class InvalidTokenError extends Error {\n}\nInvalidTokenError.prototype.name = \"InvalidTokenError\";\nfunction b64DecodeUnicode(str) {\n    return decodeURIComponent(atob(str).replace(/(.)/g, (m, p) => {\n        let code = p.charCodeAt(0).toString(16).toUpperCase();\n        if (code.length < 2) {\n            code = \"0\" + code;\n        }\n        return \"%\" + code;\n    }));\n}\nfunction base64UrlDecode(str) {\n    let output = str.replace(/-/g, \"+\").replace(/_/g, \"/\");\n    switch (output.length % 4) {\n        case 0:\n            break;\n        case 2:\n            output += \"==\";\n            break;\n        case 3:\n            output += \"=\";\n            break;\n        default:\n            throw new Error(\"base64 string is not of the correct length\");\n    }\n    try {\n        return b64DecodeUnicode(output);\n    }\n    catch (err) {\n        return atob(output);\n    }\n}\nexport function jwtDecode(token, options) {\n    if (typeof token !== \"string\") {\n        throw new InvalidTokenError(\"Invalid token specified: must be a string\");\n    }\n    options || (options = {});\n    const pos = options.header === true ? 0 : 1;\n    const part = token.split(\".\")[pos];\n    if (typeof part !== \"string\") {\n        throw new InvalidTokenError(`Invalid token specified: missing part #${pos + 1}`);\n    }\n    let decoded;\n    try {\n        decoded = base64UrlDecode(part);\n    }\n    catch (e) {\n        throw new InvalidTokenError(`Invalid token specified: invalid base64 for part #${pos + 1} (${e.message})`);\n    }\n    try {\n        return JSON.parse(decoded);\n    }\n    catch (e) {\n        throw new InvalidTokenError(`Invalid token specified: invalid json for part #${pos + 1} (${e.message})`);\n    }\n}\n","import React, { useState, useEffect } from 'react';\r\nimport { useDispatch } from 'react-redux';\r\nimport { useLoginMutation } from '../../Redux/User/apiSlice';\r\nimport { setCredentials } from '../../Redux/User/userSlice';\r\nimport { useNavigate, useLocation } from 'react-router-dom';\r\nimport { jwtDecode } from 'jwt-decode'; \r\nimport Notification from '../shared/Notification/Notification';\r\n\r\nconst Login = () => {\r\n  const [userName, setUserName] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [errorMessage, setErrorMessage] = useState('');\r\n  const dispatch = useDispatch();\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n\r\n  const [login, { isLoading }] = useLoginMutation();\r\n\r\n  const [notificationOpen, setNotificationOpen] = useState(false);\r\n  const [notificationMessage, setNotificationMessage] = useState('');\r\n  const [notificationSeverity, setNotificationSeverity] = useState('success');\r\n\r\n  const from = location.state?.from ||  { pathname: '/' }; ;\r\n\r\n  const handleLogin = async (e) => {\r\n    e.preventDefault();\r\n    setErrorMessage('');\r\n    try {\r\n      const userData = await login({ userName, password }).unwrap();\r\n      if (userData?.accessToken) {\r\n        const decodedUser = jwtDecode(userData.accessToken);\r\n        const userInfo = { ...decodedUser, token: userData.accessToken };\r\n        localStorage.setItem('user', JSON.stringify(userInfo));\r\n        dispatch(setCredentials(userInfo));\r\n        showNotification('success', 'Login successful!');\r\n        navigate(from.pathname + from.search, { replace: true });\r\n      } else {\r\n        throw new Error('Token is missing or invalid.');\r\n      }\r\n    } catch (err) {\r\n\r\n      const errorMsg = err?.data?.msg || err?.mmsg || 'Đăng nhập thất bại. Vui lòng thử lại.';\r\n      setErrorMessage(errorMsg);\r\n      showNotification('error', errorMsg);\r\n    }\r\n  };\r\n\r\n  const handleSocialLoginSuccess = (token) => {\r\n    try {\r\n      const decodedUser = jwtDecode(token);\r\n      const userInfo = { ...decodedUser, token };\r\n      console.log(\"Full Name:\", decodedUser.fullName);\r\n      localStorage.setItem('user', JSON.stringify(userInfo));\r\n      dispatch(setCredentials(userInfo));\r\n      navigate(from.pathname + from.search, { replace: true });\r\n      showNotification('success', 'Social login successful!');\r\n    } catch (error) {\r\n      setErrorMessage('Social login failed. Please try again.');\r\n      showNotification('error', 'Social login failed. Please try again.');\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    const params = new URLSearchParams(location.search);\r\n    const token = params.get('token');\r\n    const from = params.get('from') || '/'; // Trang mặc định là trang chủ\r\n  \r\n    if (token) {\r\n      handleSocialLoginSuccess(token); // Hàm xử lý token và đăng nhập người dùng\r\n      navigate(from); // Điều hướng về trang trước đó sau khi đăng nhập thành công\r\n    }\r\n  }, [location]);\r\n  \r\n\r\n  const handleFacebookLogin = () => {\r\n    window.location.href = `${process.env.REACT_APP_API_URL}/api/user/facebook`;\r\n  };\r\n\r\n  const handleGoogleLogin = () => {\r\n    window.location.href = `${process.env.REACT_APP_API_URL}/api/user/google`;\r\n  };\r\n\r\n  const showNotification = (severity, message) => {\r\n    setNotificationSeverity(severity);\r\n    setNotificationMessage(message);\r\n    setNotificationOpen(true);\r\n  };\r\n\r\n  // Handle closing the notification\r\n  const handleNotificationClose = () => {\r\n    setNotificationOpen(false);\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen flex items-center justify-center bg-gray-100\">\r\n      <div className=\"bg-white shadow-md rounded-lg p-8 w-full max-w-md\">\r\n        <h2 className=\"text-2xl font-bold text-center mb-6\">Welcome Back!</h2>\r\n        \r\n        {/* Form */}\r\n        <form className=\"space-y-4\" onSubmit={handleLogin}>\r\n          <div>\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Username\"\r\n              value={userName}\r\n              onChange={(e) => setUserName(e.target.value)}\r\n              required\r\n              className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n            />\r\n          </div>\r\n          <div>\r\n            <input\r\n              type=\"password\"\r\n              placeholder=\"Password\"\r\n              value={password}\r\n              onChange={(e) => setPassword(e.target.value)}\r\n              required\r\n              className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n            />\r\n          </div>\r\n          {errorMessage && <p className=\"text-red-500 text-xs italic\">{errorMessage}</p>}\r\n          <div className=\"flex items-center justify-between mb-4\">\r\n           <a href=\"/register\" className=\"text-sm text-blue-500 hover:text-blue-700\">Register Now?</a>\r\n            <a href=\"/forgot-password\" className=\"text-sm text-blue-500 hover:text-blue-700\">Did you forget your password?</a>\r\n          </div>\r\n          <button\r\n            type=\"submit\"\r\n            className=\"w-full bg-black text-white font-bold py-2 px-4 rounded hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-gray-500\"\r\n          >\r\n            {isLoading ? 'Logging in...' : 'Log In'}\r\n          </button>\r\n        </form>\r\n\r\n        <div className=\"flex items-center my-4\">\r\n          <hr className=\"flex-grow border-gray-300\" />\r\n          <span className=\"mx-4 text-gray-500\">OR</span>\r\n          <hr className=\"flex-grow border-gray-300\" />\r\n        </div>\r\n\r\n        {/* Social Login Buttons */}\r\n        <div className=\"flex justify-center space-x-4\">\r\n          <button onClick={handleGoogleLogin} className=\"flex items-center bg-gray-100 hover:bg-gray-200 text-gray-700 font-semibold py-2 px-4 rounded-full\">\r\n            <img src=\"https://img.icons8.com/color/48/000000/google-logo.png\" alt=\"Google\" className=\"h-6 w-6 mr-2\" />\r\n            Google\r\n          </button>\r\n          <button onClick={handleFacebookLogin} className=\"flex items-center bg-gray-100 hover:bg-gray-200 text-gray-700 font-semibold py-2 px-4 rounded-full\">\r\n            <img src=\"https://img.icons8.com/color/48/000000/facebook-new.png\" alt=\"Facebook\" className=\"h-6 w-6 mr-2\" />\r\n            Facebook\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Snackbar notification component */}\r\n      <Notification\r\n        open={notificationOpen}\r\n        onClose={handleNotificationClose}\r\n        severity={notificationSeverity}\r\n        message={notificationMessage}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Login;\r\n"],"names":["InvalidTokenError","Error","base64UrlDecode","str","output","replace","length","decodeURIComponent","atob","m","p","code","charCodeAt","toString","toUpperCase","b64DecodeUnicode","err","jwtDecode","token","options","pos","header","part","split","decoded","e","message","JSON","parse","prototype","name","Login","_location$state","userName","setUserName","useState","password","setPassword","errorMessage","setErrorMessage","dispatch","useDispatch","navigate","useNavigate","location","useLocation","login","isLoading","useLoginMutation","notificationOpen","setNotificationOpen","notificationMessage","setNotificationMessage","notificationSeverity","setNotificationSeverity","from","state","pathname","handleSocialLoginSuccess","decodedUser","userInfo","console","log","fullName","localStorage","setItem","stringify","setCredentials","search","showNotification","error","useEffect","params","URLSearchParams","get","severity","_jsxs","className","children","_jsx","onSubmit","async","preventDefault","userData","unwrap","accessToken","_err$data","errorMsg","data","msg","mmsg","type","placeholder","value","onChange","target","required","href","onClick","handleGoogleLogin","window","src","alt","handleFacebookLogin","Notification","open","onClose","handleNotificationClose"],"sourceRoot":""}