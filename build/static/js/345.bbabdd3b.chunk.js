"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[345],{43345:(e,s,t)=>{t.r(s),t.d(s,{default:()=>f});var n=t(65043),a=t(83003),i=t(90480),l=t(23927),r=t(3188),o=t(40322),c=t(91686),d=t(99472),m=t(90696),h=t(48677),u=t(91995),p=t(70579);const x=e=>{let{busType:s,closeDrawer:t}=e;const[a]=(0,i.T$)(),[l]=(0,i.Od)(),[r,o]=(0,n.useState)({name:"",description:"",seats:40,floorCount:1,images:[]}),[c,d]=(0,n.useState)([]);(0,n.useEffect)((()=>{s&&(o({name:s.name,description:s.description||"",seats:s.seats,floorCount:s.floorCount||1,images:s.images||[]}),d(s.images||[]))}),[s]);const m=e=>{const{name:s,value:t}=e.target;o({...r,[s]:t})};return(0,p.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const n=new FormData;n.append("name",r.name),n.append("description",r.description),n.append("seats",r.seats),n.append("floorCount",r.floorCount),r.images.forEach((e=>{n.append("images",e)}));try{s?(await l({id:s._id,updatedBusType:n}).unwrap(),t(`C\u1eadp nh\u1eadt lo\u1ea1i xe "${r.name}" th\xe0nh c\xf4ng!`)):(await a(n).unwrap(),t(`Th\xeam lo\u1ea1i xe "${r.name}" th\xe0nh c\xf4ng!`))}catch(i){t(`L\u1ed7i khi l\u01b0u lo\u1ea1i xe: ${i.message}`,"error"),console.error("L\u1ed7i khi l\u01b0u lo\u1ea1i xe:",i)}},children:[(0,p.jsxs)("div",{className:"mb-6",children:[(0,p.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"T\xean Lo\u1ea1i Xe:"}),(0,p.jsx)("input",{type:"text",name:"name",value:r.name,onChange:m,className:"mt-2 p-2 border rounded w-full",required:!0})]}),(0,p.jsxs)("div",{className:"mb-6",children:[(0,p.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"M\xf4 T\u1ea3:"}),(0,p.jsx)("textarea",{name:"description",value:r.description,onChange:m,className:"mt-2 p-2 border rounded w-full"})]}),(0,p.jsxs)("div",{className:"mb-6",children:[(0,p.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"S\u1ed1 Gh\u1ebf:"}),(0,p.jsx)("input",{type:"number",name:"seats",value:r.seats,onChange:m,className:"mt-2 p-2 border rounded w-full",min:"1",required:!0})]}),(0,p.jsxs)("div",{className:"mb-6",children:[(0,p.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"S\u1ed1 T\u1ea7ng:"}),(0,p.jsx)("input",{type:"number",name:"floorCount",value:r.floorCount,onChange:m,className:"mt-2 p-2 border rounded w-full",min:"1"})]}),(0,p.jsxs)("div",{className:"mb-6",children:[(0,p.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"H\xecnh \u1ea2nh:"}),(0,p.jsx)("input",{type:"file",accept:"image/*",multiple:!0,onChange:e=>{const s=Array.from(e.target.files);if(s.length+r.images.length>5)return void alert("B\u1ea1n ch\u1ec9 c\xf3 th\u1ec3 t\u1ea3i l\xean t\u1ed1i \u0111a 5 h\xecnh \u1ea3nh");const t=[...r.images,...s];o({...r,images:t});const n=s.map((e=>URL.createObjectURL(e)));d((e=>[...e,...n]))},className:"mt-2 p-2 border rounded w-full"}),(0,p.jsx)("div",{className:"flex mt-4 gap-2",children:c.map(((e,s)=>(0,p.jsx)("img",{src:e,alt:`Preview ${s+1}`,className:"w-20 h-20 object-cover rounded border"},s)))})]}),(0,p.jsx)("button",{type:"submit",className:"bg-green-500 text-white px-4 py-2 rounded w-full",children:s?"C\u1eadp Nh\u1eadt Lo\u1ea1i Xe":"Th\xeam Lo\u1ea1i Xe"})]})};var g=t(76384);const{Title:y}=l.A,j=()=>{const e=(0,a.d4)((e=>{var s,t;return null===(s=e.user)||void 0===s||null===(t=s.userInfo)||void 0===t?void 0:t.companyId})),{data:s,isLoading:t,error:l,refetch:j}=(0,i.rz)({companyId:e}),f=(null===s||void 0===s?void 0:s.data)||[],[v]=(0,i.OE)(),[b,C]=(0,n.useState)(!1),[w,k]=(0,n.useState)(null),[N,T]=(0,n.useState)({open:!1,severity:"info",message:""}),[A,S]=(0,n.useState)(!1),[L,X]=(0,n.useState)([]),I=e=>{C(!1),e&&(T({open:!0,severity:"success",message:e}),j())},$=[{title:"T\xean Lo\u1ea1i Xe",dataIndex:"name",key:"name"},{title:"M\xf4 T\u1ea3",dataIndex:"description",key:"description"},{title:"S\u1ed1 Gh\u1ebf",dataIndex:"seats",key:"seats"},{title:"S\u1ed1 T\u1ea7ng",dataIndex:"floorCount",key:"floorCount"},{title:"H\xecnh \u1ea2nh",dataIndex:"images",key:"images",render:e=>(0,p.jsxs)("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[e.slice(0,2).map(((e,s)=>(0,p.jsx)("img",{src:e,alt:`Bus type preview ${s+1}`,style:{width:50,height:50,objectFit:"cover",borderRadius:"4px"}},s))),e.length>2&&(0,p.jsx)(r.Ay,{type:"link",onClick:()=>(e=>{X(e),S(!0)})(e),children:"Xem Th\xeam"})]})},{title:"Thao T\xe1c",key:"action",render:(e,s)=>(0,p.jsxs)("span",{children:[(0,p.jsx)(r.Ay,{type:"link",onClick:()=>(k(s),void C(!0)),children:"S\u1eeda"}),(0,p.jsx)(o.A,{title:"B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n x\xf3a lo\u1ea1i xe n\xe0y kh\xf4ng?",onConfirm:()=>(async e=>{try{await v(e).unwrap(),T({open:!0,severity:"success",message:"X\xf3a lo\u1ea1i xe th\xe0nh c\xf4ng!"}),j()}catch(l){T({open:!0,severity:"error",message:`L\u1ed7i khi x\xf3a lo\u1ea1i xe: ${l.message}`})}})(s._id),okText:"C\xf3",cancelText:"Kh\xf4ng",children:(0,p.jsx)(r.Ay,{type:"link",danger:!0,children:"X\xf3a"})})]})}];return(0,p.jsxs)("div",{className:"p-6 bg-white shadow-md rounded-lg",children:[(0,p.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,p.jsx)(y,{level:3,className:"text-gray-700",children:"Danh S\xe1ch C\xe1c Lo\u1ea1i Xe"}),(0,p.jsx)(r.Ay,{type:"primary",onClick:()=>{k(null),C(!0)},children:"Th\xeam Lo\u1ea1i Xe M\u1edbi"})]}),t?(0,p.jsx)("div",{className:"flex justify-center items-center py-10",children:(0,p.jsx)(c.A,{tip:"\u0110ang t\u1ea3i danh s\xe1ch lo\u1ea1i xe...",size:"large"})}):l?(0,p.jsx)("div",{className:"flex justify-center items-center py-10",children:(0,p.jsxs)("p",{children:["L\u1ed7i khi t\u1ea3i d\u1eef li\u1ec7u: ",l.message]})}):0===f.length?(0,p.jsx)("div",{className:"flex justify-center items-center py-10",children:(0,p.jsx)(d.A,{description:"Kh\xf4ng c\xf3 lo\u1ea1i xe n\xe0o"})}):(0,p.jsx)(m.A,{dataSource:f,columns:$,rowKey:"_id",pagination:{pageSize:5}}),(0,p.jsx)(h.A,{title:w?"Ch\u1ec9nh S\u1eeda Lo\u1ea1i Xe":"Th\xeam Lo\u1ea1i Xe M\u1edbi",width:500,onClose:()=>I(),visible:b,destroyOnClose:!0,children:(0,p.jsx)(x,{busType:w,closeDrawer:e=>I(e)})}),(0,p.jsx)(u.A,{title:"T\u1ea5t C\u1ea3 H\xecnh \u1ea2nh",visible:A,footer:null,onCancel:()=>{S(!1),X([])},children:(0,p.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"10px"},children:L.map(((e,s)=>(0,p.jsx)("img",{src:e,alt:`Bus type full view ${s+1}`,style:{width:100,height:100,objectFit:"cover",borderRadius:"4px"}},s)))})}),(0,p.jsx)(g.A,{open:N.open,severity:N.severity,message:N.message,onClose:()=>T({...N,open:!1})})]})},f=()=>(0,p.jsx)("div",{className:"p-8",children:(0,p.jsx)(j,{})})},76384:(e,s,t)=>{t.d(s,{A:()=>c});var n=t(65043),a=t(90182),i=t(77518),l=t(5897),r=t(70579);const o=n.forwardRef((function(e,s){return(0,r.jsx)(i.A,{elevation:6,ref:s,variant:"filled",...e})})),c=e=>{let{open:s,onClose:t,severity:n,message:i,autoHideDuration:c=3e3,TransitionComponent:d=l.A}=e;return(0,r.jsx)(a.A,{open:s,autoHideDuration:c,onClose:t,TransitionComponent:d,anchorOrigin:{vertical:"top",horizontal:"right"},children:(0,r.jsx)(o,{onClose:t,severity:n,sx:{width:"100%"},children:i})})}}}]);
//# sourceMappingURL=345.bbabdd3b.chunk.js.map