"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[843],{27843:(e,t,s)=>{s.r(t),s.d(t,{default:()=>o});var a=s(65043),n=s(3836),l=s(6720),r=s(75995),c=s(70579);const i=e=>{var t,s,a,n,r;let{booking:i,onCancel:d,activeTab:o}=e;const u=(null===(t=i.trip)||void 0===t||null===(s=t.departureLocation)||void 0===s?void 0:s.name)||"N/A",m=(null===(a=i.trip)||void 0===a||null===(n=a.arrivalLocation)||void 0===n?void 0:n.name)||"N/A",x=null!==(r=i.trip)&&void 0!==r&&r.departureTime?new Date(i.trip.departureTime):null;return(0,c.jsxs)("div",{className:"bg-gray-50 shadow-lg rounded-lg p-6 mb-4 transition-transform transform hover:scale-105",children:[(0,c.jsxs)("div",{className:"flex justify-between items-start",children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)("h3",{className:"text-xl font-semibold text-gray-800 flex items-center",children:[(0,c.jsx)(l.gwi,{className:"text-blue-500 mr-2"}),u," \u2192 ",m]}),(0,c.jsxs)("p",{className:"text-sm text-gray-600 flex items-center mt-1",children:[(0,c.jsx)(l.Hvs,{className:"text-blue-500 mr-2"}),x?`${x.toLocaleDateString()} - ${x.toLocaleTimeString()}`:"Th\u1eddi gian kh\xf4ng c\xf3 s\u1eb5n"]})]}),(0,c.jsx)("span",{className:"px-3 py-1 text-xs rounded-full font-semibold "+("Confirmed"===i.status?"bg-green-100 text-green-600":"Completed"===i.status?"bg-blue-100 text-blue-600":"bg-red-100 text-red-600"),children:i.status})]}),(0,c.jsxs)("div",{className:"mt-4 flex justify-between items-center",children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"flex items-center text-gray-700 mb-2",children:[(0,c.jsx)(l.r$9,{className:"text-blue-500 mr-2"}),(0,c.jsx)("span",{className:"font-semibold",children:"Gh\u1ebf:"})," ",i.seatNumbers.join(", ")]}),(0,c.jsxs)("div",{className:"flex items-center text-gray-700 mb-2",children:[(0,c.jsx)("span",{className:"text-blue-500 mr-2",children:"\ud83d\udcb2"}),(0,c.jsx)("span",{className:"font-semibold",children:"Gi\xe1 v\xe9:"})," ",i.totalPrice.toLocaleString()," VND"]}),(0,c.jsxs)("div",{className:"flex items-center text-gray-700",children:[(0,c.jsx)(l.WYw,{className:"text-blue-500 mr-2"}),(0,c.jsx)("span",{className:"font-semibold",children:"M\xe3 \u0111\u1eb7t v\xe9:"})," ",i.orderCode]})]}),"Confirmed"===i.status&&"completed"!==o&&(0,c.jsx)("button",{onClick:()=>d(i._id),className:"bg-red-500 text-white px-4 py-2 rounded-lg",children:"H\u1ee7y v\xe9"})]})]})},d=e=>{let{totalPages:t,currentPage:s,onPageChange:a,onNextPage:n,onPrevPage:l}=e;return(0,c.jsxs)("div",{className:"flex justify-center mt-6 space-x-2",children:[(0,c.jsx)("button",{onClick:l,disabled:1===s,className:"px-3 py-1 rounded-lg "+(1===s?"bg-gray-300 cursor-not-allowed":"bg-blue-500 text-white"),children:"Quay l\u1ea1i"}),[...Array(t).keys()].map((e=>(0,c.jsx)("button",{onClick:()=>a(e+1),className:"px-3 py-1 rounded-lg "+(e+1===s?"bg-blue-500 text-white":"bg-gray-200 text-gray-700"),children:e+1},e+1))),(0,c.jsx)("button",{onClick:n,disabled:s===t,className:"px-3 py-1 rounded-lg "+(s===t?"bg-gray-300 cursor-not-allowed":"bg-blue-500 text-white"),children:"Trang ti\u1ebfp"})]})},o=()=>{const[e,t]=(0,a.useState)([]),[s,l]=(0,a.useState)({current:0,completed:0,canceled:0}),[o,u]=(0,a.useState)("current"),[m,x]=(0,a.useState)(1),{data:h,isLoading:g,isError:b,refetch:p}=(0,n.dH)(),[v]=(0,n.wC)(),[j,y]=(0,a.useState)({open:!1,severity:"info",message:""}),f=(e,t)=>{y({open:!0,severity:e,message:t})};(0,a.useEffect)((()=>{if(null!==h&&void 0!==h&&h.success){const e=h.data.reduce(((e,t)=>{var s,a;const n=new Date(t.bookingDate).toLocaleDateString();let l;return"Scheduled"===(null===(s=t.trip)||void 0===s?void 0:s.status)&&"Confirmed"===t.status?l="current":"Completed"===(null===(a=t.trip)||void 0===a?void 0:a.status)&&"Confirmed"===t.status?l="completed":"Cancelled"===t.status&&(l="canceled"),l&&(e[l]||(e[l]={}),e[l][n]||(e[l][n]=[]),e[l][n].push(t)),e}),{});t(e),l({current:e.current?Object.values(e.current).flat().length:0,completed:e.completed?Object.values(e.completed).flat().length:0,canceled:e.canceled?Object.values(e.canceled).flat().length:0})}}),[h]);const N=e=>{x(e)},w=()=>{x((e=>e+1))},C=()=>{x((e=>Math.max(e-1,1)))},k=async e=>{try{await v(e).unwrap(),f("success","H\u1ee7y v\xe9 th\xe0nh c\xf4ng!"),p()}catch(t){f("error",`L\u1ed7i khi h\u1ee7y v\xe9: ${t.message}`)}};if(g)return(0,c.jsx)("p",{children:"Loading..."});if(b||null===h||void 0===h||!h.success)return(0,c.jsx)("div",{className:"container mx-auto mt-10 bg-white shadow-md rounded-lg p-8",children:(0,c.jsxs)("p",{children:["B\u1ea1n ch\u01b0a c\xf3 l\u1ecbch s\u1eed \u0111\u1eb7t v\xe9 n\xe0o. ",(0,c.jsx)("a",{href:"/",className:"text-blue-600",children:"\u0110\u1eb7t v\xe9 ngay!"})]})});return(0,c.jsxs)("div",{className:"container mx-auto mt-10 bg-white shadow-md rounded-lg p-8",children:[(0,c.jsx)("div",{className:"border-b border-gray-300 mb-6",children:(0,c.jsx)("nav",{className:"flex justify-center space-x-8",children:["current","completed","canceled"].map((e=>(0,c.jsx)("button",{onClick:()=>{u(e),x(1)},className:"py-3 px-4 text-lg font-semibold "+(o===e?"text-blue-600 border-b-2 border-blue-500":"text-gray-600"),children:"current"===e?`Hi\u1ec7n t\u1ea1i (${s.current})`:"completed"===e?`\u0110\xe3 \u0111i (${s.completed})`:`\u0110\xe3 h\u1ee7y (${s.canceled})`},e)))})}),(0,c.jsx)("div",{children:(t=>{const s=e[t];if(!s||0===Object.keys(s).length)return(0,c.jsxs)("p",{className:"text-gray-600",children:["current"===t?"B\u1ea1n ch\u01b0a c\xf3 chuy\u1ebfn s\u1eafp \u0111i n\xe0o. ":"completed"===t?"B\u1ea1n ch\u01b0a c\xf3 chuy\u1ebfn n\xe0o \u0111\xe3 ho\xe0n th\xe0nh.":"B\u1ea1n ch\u01b0a c\xf3 v\xe9 n\xe0o \u0111\xe3 h\u1ee7y.","current"===t&&(0,c.jsx)("a",{href:"/book",className:"text-blue-600",children:"\u0110\u1eb7t chuy\u1ebfn \u0111i ngay!"})]});const a=Object.entries(s),n=Math.ceil(a.length/5),l=a.slice(5*(m-1),5*m);return(0,c.jsxs)(c.Fragment,{children:[l.map((e=>{let[t,s]=e;return(0,c.jsxs)("div",{className:"mb-8",children:[(0,c.jsx)("h3",{className:"text-lg font-semibold text-gray-700 mb-4",children:t}),s.map((e=>(0,c.jsx)(i,{booking:e,activeTab:o,onCancel:k},e._id)))]},t)})),(0,c.jsx)(d,{totalPages:n,currentPage:m,onPageChange:N,onNextPage:w,onPrevPage:C})]})})(o)}),(0,c.jsx)(r.A,{open:j.open,onClose:()=>{y((e=>({...e,open:!1})))},severity:j.severity,message:j.message})]})}}}]);
//# sourceMappingURL=843.832f7922.chunk.js.map