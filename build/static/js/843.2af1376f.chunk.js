"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[843],{27843:(e,t,s)=>{s.r(t),s.d(t,{default:()=>d});var n=s(65043),a=s(3836),r=s(6720),l=s(76384),c=s(70579);const i=e=>{var t,s,n,a,l;let{booking:i,onCancel:o}=e;const d=(null===(t=i.trip)||void 0===t||null===(s=t.departureLocation)||void 0===s?void 0:s.name)||"N/A",u=(null===(n=i.trip)||void 0===n||null===(a=n.arrivalLocation)||void 0===a?void 0:a.name)||"N/A",m=null!==(l=i.trip)&&void 0!==l&&l.departureTime?new Date(i.trip.departureTime):null;return(0,c.jsxs)("div",{className:"bg-gray-50 shadow-lg rounded-lg p-6 mb-4 transition-transform transform hover:scale-105",children:[(0,c.jsxs)("div",{className:"flex justify-between items-start",children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)("h3",{className:"text-xl font-semibold text-gray-800 flex items-center",children:[(0,c.jsx)(r.gwi,{className:"text-blue-500 mr-2"}),d," \u2192 ",u]}),(0,c.jsxs)("p",{className:"text-sm text-gray-600 flex items-center mt-1",children:[(0,c.jsx)(r.Hvs,{className:"text-blue-500 mr-2"}),m?`${m.toLocaleDateString()} - ${m.toLocaleTimeString()}`:"Th\u1eddi gian kh\xf4ng c\xf3 s\u1eb5n"]})]}),(0,c.jsx)("span",{className:"px-3 py-1 text-xs rounded-full font-semibold "+("Confirmed"===i.status?"bg-green-100 text-green-600":"Completed"===i.status?"bg-blue-100 text-blue-600":"bg-red-100 text-red-600"),children:i.status})]}),(0,c.jsxs)("div",{className:"mt-4 flex justify-between items-center",children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"flex items-center text-gray-700 mb-2",children:[(0,c.jsx)(r.r$9,{className:"text-blue-500 mr-2"}),(0,c.jsx)("span",{className:"font-semibold",children:"Gh\u1ebf:"})," ",i.seatNumbers.join(", ")]}),(0,c.jsxs)("div",{className:"flex items-center text-gray-700 mb-2",children:[(0,c.jsx)("span",{className:"text-blue-500 mr-2",children:"\ud83d\udcb2"}),(0,c.jsx)("span",{className:"font-semibold",children:"Gi\xe1 v\xe9:"})," ",i.totalPrice.toLocaleString()," VND"]}),(0,c.jsxs)("div",{className:"flex items-center text-gray-700",children:[(0,c.jsx)(r.WYw,{className:"text-blue-500 mr-2"}),(0,c.jsx)("span",{className:"font-semibold",children:"M\xe3 \u0111\u1eb7t v\xe9:"})," ",i.orderCode]})]}),"Confirmed"===i.status&&(0,c.jsx)("button",{onClick:()=>o(i._id),className:"bg-red-500 text-white px-4 py-2 rounded-lg",children:"H\u1ee7y v\xe9"})]})]})},o=e=>{let{totalPages:t,currentPage:s,onPageChange:n,onNextPage:a,onPrevPage:r}=e;return(0,c.jsxs)("div",{className:"flex justify-center mt-6 space-x-2",children:[(0,c.jsx)("button",{onClick:r,disabled:1===s,className:"px-3 py-1 rounded-lg "+(1===s?"bg-gray-300 cursor-not-allowed":"bg-blue-500 text-white"),children:"Quay l\u1ea1i"}),[...Array(t).keys()].map((e=>(0,c.jsx)("button",{onClick:()=>n(e+1),className:"px-3 py-1 rounded-lg "+(e+1===s?"bg-blue-500 text-white":"bg-gray-200 text-gray-700"),children:e+1},e+1))),(0,c.jsx)("button",{onClick:a,disabled:s===t,className:"px-3 py-1 rounded-lg "+(s===t?"bg-gray-300 cursor-not-allowed":"bg-blue-500 text-white"),children:"Trang ti\u1ebfp"})]})},d=()=>{const[e,t]=(0,n.useState)([]),[s,r]=(0,n.useState)({current:0,completed:0,canceled:0}),[d,u]=(0,n.useState)("current"),[m,x]=(0,n.useState)(1),{data:h,isLoading:g,isError:b,refetch:p}=(0,a.dH)(),[v]=(0,a.wC)(),[j,f]=(0,n.useState)({open:!1,severity:"info",message:""}),y=(e,t)=>{f({open:!0,severity:e,message:t})};(0,n.useEffect)((()=>{if(null!==h&&void 0!==h&&h.success){const e=h.data.reduce(((e,t)=>{var s,n;const a=new Date(t.bookingDate).toLocaleDateString();let r;return"Scheduled"===(null===(s=t.trip)||void 0===s?void 0:s.status)&&"Confirmed"===t.status?r="current":"Completed"===(null===(n=t.trip)||void 0===n?void 0:n.status)&&"Confirmed"===t.status?r="completed":"Cancelled"===t.status&&(r="canceled"),r&&(e[r]||(e[r]={}),e[r][a]||(e[r][a]=[]),e[r][a].push(t)),e}),{});t(e),r({current:e.current?Object.values(e.current).flat().length:0,completed:e.completed?Object.values(e.completed).flat().length:0,canceled:e.canceled?Object.values(e.canceled).flat().length:0})}}),[h]);const N=e=>{x(e)},C=()=>{x((e=>e+1))},w=()=>{x((e=>Math.max(e-1,1)))},k=async e=>{try{await v(e).unwrap(),y("success","H\u1ee7y v\xe9 th\xe0nh c\xf4ng!"),p()}catch(t){y("error",`L\u1ed7i khi h\u1ee7y v\xe9: ${t.message}`)}};if(g)return(0,c.jsx)("p",{children:"Loading..."});if(b||null===h||void 0===h||!h.success)return(0,c.jsx)("div",{className:"container mx-auto mt-10 bg-white shadow-md rounded-lg p-8",children:(0,c.jsxs)("p",{children:["B\u1ea1n ch\u01b0a c\xf3 l\u1ecbch s\u1eed \u0111\u1eb7t v\xe9 n\xe0o. ",(0,c.jsx)("a",{href:"/",className:"text-blue-600",children:"\u0110\u1eb7t v\xe9 ngay!"})]})});return(0,c.jsxs)("div",{className:"container mx-auto mt-10 bg-white shadow-md rounded-lg p-8",children:[(0,c.jsx)("div",{className:"border-b border-gray-300 mb-6",children:(0,c.jsx)("nav",{className:"flex justify-center space-x-8",children:["current","completed","canceled"].map((e=>(0,c.jsx)("button",{onClick:()=>{u(e),x(1)},className:"py-3 px-4 text-lg font-semibold "+(d===e?"text-blue-600 border-b-2 border-blue-500":"text-gray-600"),children:"current"===e?`Hi\u1ec7n t\u1ea1i (${s.current})`:"completed"===e?`\u0110\xe3 \u0111i (${s.completed})`:`\u0110\xe3 h\u1ee7y (${s.canceled})`},e)))})}),(0,c.jsx)("div",{children:(t=>{const s=e[t];if(!s||0===Object.keys(s).length)return(0,c.jsxs)("p",{className:"text-gray-600",children:["current"===t?"B\u1ea1n ch\u01b0a c\xf3 chuy\u1ebfn s\u1eafp \u0111i n\xe0o. ":"completed"===t?"B\u1ea1n ch\u01b0a c\xf3 chuy\u1ebfn n\xe0o \u0111\xe3 ho\xe0n th\xe0nh.":"B\u1ea1n ch\u01b0a c\xf3 v\xe9 n\xe0o \u0111\xe3 h\u1ee7y.","current"===t&&(0,c.jsx)("a",{href:"/book",className:"text-blue-600",children:"\u0110\u1eb7t chuy\u1ebfn \u0111i ngay!"})]});const n=Object.entries(s),a=Math.ceil(n.length/5),r=n.slice(5*(m-1),5*m);return(0,c.jsxs)(c.Fragment,{children:[r.map((e=>{let[t,s]=e;return(0,c.jsxs)("div",{className:"mb-8",children:[(0,c.jsx)("h3",{className:"text-lg font-semibold text-gray-700 mb-4",children:t}),s.map((e=>(0,c.jsx)(i,{booking:e,onCancel:k},e._id)))]},t)})),(0,c.jsx)(o,{totalPages:a,currentPage:m,onPageChange:N,onNextPage:C,onPrevPage:w})]})})(d)}),(0,c.jsx)(l.A,{open:j.open,onClose:()=>{f((e=>({...e,open:!1})))},severity:j.severity,message:j.message})]})}},76384:(e,t,s)=>{s.d(t,{A:()=>o});var n=s(65043),a=s(90182),r=s(77518),l=s(5897),c=s(70579);const i=n.forwardRef((function(e,t){return(0,c.jsx)(r.A,{elevation:6,ref:t,variant:"filled",...e})})),o=e=>{let{open:t,onClose:s,severity:n,message:r,autoHideDuration:o=3e3,TransitionComponent:d=l.A}=e;return(0,c.jsx)(a.A,{open:t,autoHideDuration:o,onClose:s,TransitionComponent:d,anchorOrigin:{vertical:"top",horizontal:"right"},children:(0,c.jsx)(i,{onClose:s,severity:n,sx:{width:"100%"},children:r})})}}}]);
//# sourceMappingURL=843.2af1376f.chunk.js.map